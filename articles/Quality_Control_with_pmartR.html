<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Quality Control and Normalization of Peptide Data with the `pmartR` Package • pmartR</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Quality Control and Normalization of Peptide Data with the `pmartR` Package">
<meta property="og:description" content="pmartR">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">pmartR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.2.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Quality_Control_with_pmartR.html">Quality Control and Normalization of Peptide Data with the `pmartR` Package</a>
    </li>
    <li>
      <a href="../articles/Statistical_Analysis_with_pmartR.html">Statistical Analysis with the `pmartR` Package</a>
    </li>
    <li>
      <a href="../articles/Trelliscope_Vignette.html">Using Trelliscope Functions with pmartR</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/pmartR/pmartR/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Quality Control and Normalization of Peptide Data with the <code>pmartR</code> Package</h1>
                        <h4 data-toc-skip class="author">Kelly Stratton, Lisa Bramer</h4>
            
            <h4 data-toc-skip class="date">2022-10-13</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/pmartR/pmartR/blob/HEAD/vignettes/Quality_Control_with_pmartR.Rmd" class="external-link"><code>vignettes/Quality_Control_with_pmartR.Rmd</code></a></small>
      <div class="hidden name"><code>Quality_Control_with_pmartR.Rmd</code></div>

    </div>

    
    
<p><img src="pmartR_logo_final.jpg" width="100px"></p>
<p>This vignette describes the pmartR package functionality for quality control (QC) processing of mass spectrometry (MS) pan-omics data, in particular proteomics data at the peptide level. This includes data transformation, specification of groups that are to be compared against each other, filtering of features and/or samples, data normalization, and data summarization (correlation, principal components analysis). It is based on example data in the pmartRdata package.</p>
<p>Additional datasets available in the pmartRdata package include the following data types: protein level data, lipidomic data, and metabolomic data. A separate vignette describes the statistical analysis capabilities of pmartR.</p>
<div class="section level2">
<h2 id="data">Data<a class="anchor" aria-label="anchor" href="#data"></a>
</h2>
<p>Below we load in 3 data.frames from the pmartRdata package:</p>
<ul>
<li><p><code>pep_edata</code>: A <span class="math inline">\(p * (n + 1)\)</span> data.frame of expression data, where <span class="math inline">\(p\)</span> is the number of peptides observed and <span class="math inline">\(n\)</span> is the number of samples (an additional peptide identifier/name column should also be present anywhere in the data.frame). Each row corresponds to data for each peptide.</p></li>
<li><p><code>pep_fdata</code>: A data.frame with <span class="math inline">\(n\)</span> rows. Each row corresponds to a sample with one column giving the unique sample identifiers found in e_data column names and other columns providing qualitative and/or quantitative traits of each sample.</p></li>
<li><p><code>pep_emeta</code>: An optional data.frame with at least <span class="math inline">\(p\)</span> rows. Each row corresponds to a peptide with one column giving peptide names (must be named the same as the column in <code>e_data</code>) and other columns giving meta information (e.g. mappings of peptides to proteins).</p></li>
</ul>
<p>Here, <span class="math inline">\(p\)</span> is 17407 and <span class="math inline">\(n\)</span> is 12. The <code>pep_fdata</code> data.frame contains the sample identifier and the condition designation for each sample, either ‘Infection’ (samples that were infected with some pathogen) or ‘Mock’ (uninfected samples used as a control). The <code>pep_emeta</code> data.frame contains the peptide identifier column (‘Mass_Tag_ID’), the protein identification name to which each mass tag ID maps (‘Protein’), a reference identifier (‘Ref_ID’), and the peptide sequence (Peptide_Sequence). Note that the mass tag IDs are unique (<span class="math inline">\(n_{peptide} =\)</span> 17407) while the protein identifiers are not (<span class="math inline">\(n_{protein} =\)</span> 2774) since multiple peptides often map to the same protein.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"pep_edata"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">pep_edata</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 17407    13</span></span></code></pre>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pep_edata</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">6</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">##    Mass_Tag_ID Infection1 Infection2 Infection3 Infection4</span></span>
<span><span class="co">## 4         1024         NA         NA         NA         NA</span></span>
<span><span class="co">## 6         1047   17953839   20071472   20745779   18206556</span></span>
<span><span class="co">## 9         1055  109536335  115459820  106127139   74522014</span></span>
<span><span class="co">## 14        1104 1752288782 1796561709 1703186182 2438218572</span></span>
<span><span class="co">## 16        1110    2571804    4269824    4852871    2630414</span></span>
<span><span class="co">## 23        1214  110239193   82436688  100447189  102006001</span></span></code></pre>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"pep_fdata"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">pep_fdata</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 12  2</span></span></code></pre>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">pep_fdata</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##     SampleID Condition</span></span>
<span><span class="co">## 1 Infection1 Infection</span></span>
<span><span class="co">## 2 Infection2 Infection</span></span>
<span><span class="co">## 3 Infection3 Infection</span></span>
<span><span class="co">## 4 Infection4 Infection</span></span>
<span><span class="co">## 5 Infection5 Infection</span></span>
<span><span class="co">## 6 Infection6 Infection</span></span></code></pre>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"pep_emeta"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">pep_emeta</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 17407     4</span></span></code></pre>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">pep_emeta</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##    Mass_Tag_ID    Protein Ref_ID         Peptide_Sequence</span></span>
<span><span class="co">## 6         1024 ACBP_HUMAN    324 K.QATVGDINTERPGMLDFTGK.A</span></span>
<span><span class="co">## 15        1047 ALBU_HUMAN    580       T.ECCHGDLLECADDR.A</span></span>
<span><span class="co">## 20        1055 RL40_HUMAN   9898     K.TITLEVEPSDTIENVK.A</span></span>
<span><span class="co">## 35        1104 ALBU_HUMAN    580      K.KVPQVSTPTLVEVSR.N</span></span>
<span><span class="co">## 39        1110  CYC_HUMAN   2918          K.TGPNLHGLFGR.K</span></span>
<span><span class="co">## 61        1214  G3P_HUMAN   4480             K.VGVNGFGR.I</span></span></code></pre>
<p>Next we create pepData object, which contains the 3 components loaded above. During object creation, we specify the names of the identifier columns in the <code>e_data</code>, <code>f_data</code>, and <code>e_meta</code> components of the data (<code>edata_cname = "Mass_Tag_ID", emeta_cname = "Protein", fdata_cname = "SampleID"</code>, respectively), as well as the scale of the data (<code>data_scale = "abundance"</code>). We can use the <code>summary</code> function to get basic summary information for our pepData object.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mypepData</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/as.pepData.html">as.pepData</a></span><span class="op">(</span>e_data <span class="op">=</span> <span class="va">pep_edata</span>, f_data <span class="op">=</span> <span class="va">pep_fdata</span>, e_meta <span class="op">=</span> <span class="va">pep_emeta</span>, edata_cname <span class="op">=</span> <span class="st">"Mass_Tag_ID"</span>, emeta_cname <span class="op">=</span> <span class="st">"Protein"</span>, fdata_cname <span class="op">=</span> <span class="st">"SampleID"</span>, data_scale <span class="op">=</span> <span class="st">"abundance"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">mypepData</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "pepData"</span></span></code></pre>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mypepData</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##                                     </span></span>
<span><span class="co">## Class                        pepData</span></span>
<span><span class="co">## Unique SampleIDs (f_data)         12</span></span>
<span><span class="co">## Unique Mass_Tag_IDs (e_data)   17407</span></span>
<span><span class="co">## Unique Proteins (e_meta)        2774</span></span>
<span><span class="co">## Missing Observations           82833</span></span>
<span><span class="co">## Proportion Missing             0.397</span></span></code></pre>
<p>Alternatively, the pmartRdata package contains the corresponding pepData object, which can be loaded as follows.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"pep_object"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">pep_object</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "pepData"</span></span></code></pre>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span><span class="va">pep_object</span><span class="op">)</span></span></code></pre></div>
<p>We can use the <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> function to display box plots for each sample in the pepData object.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mypepData</span><span class="op">)</span></span></code></pre></div>
<p><img src="Quality_Control_with_pmartR_files/figure-html/data4-1.png" width="768"></p>
<div class="section level3">
<h3 id="additional-data">Additional Data<a class="anchor" aria-label="anchor" href="#additional-data"></a>
</h3>
<p>Also included in the pmartR package are protein, metabolite, and lipid data, in analagous formats to the peptide data described above.</p>
<p>Finally, we include .csv versions of the metabolite data (e_data and f_data), where the sample names have been modified to begin with numbers and contain dashes. These are included to illustrate use of the “check.names” argument to the  (and ) functions. If we read in the e_data file without specifying , R automatically puts an “X” at the beginning of the sample names so they do not begin with a number and replaces the dashes with periods. This causes the sample names in e_data to not match the sample names in f_data, and will prevent the creation of a metabData object.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">edata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"metab_edata_sample_names.csv"</span>, package<span class="op">=</span><span class="st">"pmartRdata"</span><span class="op">)</span>, header<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">edata</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##  [1] "Metabolite"   "X1.Mock"      "X2.Mock"      "X3.Mock"      "X1.Infection"</span></span>
<span><span class="co">##  [6] "X2.Infection" "X3.Infection" "X4.Infection" "X5.Infection" "X6.Infection"</span></span>
<span><span class="co">## [11] "X7.Infection" "X8.Infection" "X9.Infection"</span></span></code></pre>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fdata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"metab_fdata_sample_names.csv"</span>, package<span class="op">=</span><span class="st">"pmartRdata"</span><span class="op">)</span>, header<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Do the sample names match each other? #</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/all.html" class="external-link">all</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">edata</span><span class="op">)</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">==</span> <span class="va">fdata</span><span class="op">$</span><span class="va">SampleID</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] FALSE</span></span></code></pre>
<p>To avoid this, without having to modify the sample names in f_data, we can specify :</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">edata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"metab_edata_sample_names.csv"</span>, package<span class="op">=</span><span class="st">"pmartRdata"</span><span class="op">)</span>, header<span class="op">=</span><span class="cn">TRUE</span>, check.names<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">edata</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##  [1] "Metabolite"  "1-Mock"      "2-Mock"      "3-Mock"      "1-Infection"</span></span>
<span><span class="co">##  [6] "2-Infection" "3-Infection" "4-Infection" "5-Infection" "6-Infection"</span></span>
<span><span class="co">## [11] "7-Infection" "8-Infection" "9-Infection"</span></span></code></pre>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Do the sample names match each other? #</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/all.html" class="external-link">all</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">edata</span><span class="op">)</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">==</span> <span class="va">fdata</span><span class="op">$</span><span class="va">SampleID</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] TRUE</span></span></code></pre>
</div>
</div>
<div class="section level2">
<h2 id="workflow">Workflow<a class="anchor" aria-label="anchor" href="#workflow"></a>
</h2>
<p>Once the pepData object is created, a typical QC workflow follows the figure below.</p>
<div class="figure">
<img src="pmartR_graphic-final.jpg" alt="Figure 1. Quality control and processing workflow in pmartR package." width="600px"><p class="caption">
Figure 1. Quality control and processing workflow in pmartR package.
</p>
</div>
<p>We will walk through the steps in this QC workflow using <code>mypepData</code>.</p>
<div class="section level3">
<h3 id="format-data">Format Data<a class="anchor" aria-label="anchor" href="#format-data"></a>
</h3>
<p>Sometimes omics abundance data contains 0s when the particular biomolecule was not detected for a given sample. It is our practice to replace any 0s with NAs as opposed to imputing the missing values. We strongly prefer NAs to imputation because we cannot know whether the biomolecule is not present in the sample, simply was below the limit of detection, or was present but missing from our data at random. The function <code><a href="../reference/edata_replace.html">edata_replace()</a></code> can be used to replace values in the pepData object.</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mypepData</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/edata_replace.html">edata_replace</a></span><span class="op">(</span><span class="va">mypepData</span>, x <span class="op">=</span> <span class="fl">0</span>, y <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## 0 instances of 0 have been replaced with NA</span></span></code></pre>
<p>In this dataset, there were no 0s so nothing was replaced.</p>
<p>We also highly recommend log transforming the data prior to analysis. pmartR supports log2, log10, and natural logarithm transformations. The <code><a href="../reference/edata_transform.html">edata_transform()</a></code> function provides this capability. We can also use <code>edata_trasnform()</code> to transform the data back to the abundance scale if needed. Note that the scale of the data is stored and automatically updated in the <code>data_info$data_scale</code> attribute of the pepData object. Below we log10 transform the data, then return to the abundance scale, and finally settle on the log2 scale.</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mypepData</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/edata_transform.html">edata_transform</a></span><span class="op">(</span><span class="va">mypepData</span>, data_scale <span class="op">=</span> <span class="st">"log10"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/attributes.html" class="external-link">attributes</a></span><span class="op">(</span><span class="va">mypepData</span><span class="op">)</span><span class="op">$</span><span class="va">data_info</span><span class="op">$</span><span class="va">data_scale</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "log10"</span></span></code></pre>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mypepData</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/edata_transform.html">edata_transform</a></span><span class="op">(</span><span class="va">mypepData</span>, data_scale <span class="op">=</span> <span class="st">"abundance"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/attributes.html" class="external-link">attributes</a></span><span class="op">(</span><span class="va">mypepData</span><span class="op">)</span><span class="op">$</span><span class="va">data_info</span><span class="op">$</span><span class="va">data_scale</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "abundance"</span></span></code></pre>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mypepData</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/edata_transform.html">edata_transform</a></span><span class="op">(</span><span class="va">mypepData</span>, data_scale <span class="op">=</span> <span class="st">"log2"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/attributes.html" class="external-link">attributes</a></span><span class="op">(</span><span class="va">mypepData</span><span class="op">)</span><span class="op">$</span><span class="va">data_info</span><span class="op">$</span><span class="va">data_scale</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "log2"</span></span></code></pre>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mypepData</span><span class="op">)</span></span></code></pre></div>
<p><img src="Quality_Control_with_pmartR_files/figure-html/format2-1.png" width="768"></p>
<p>Finally, we are preparing this data for statistical analysis where we will compare the samples belonging to one group to the samples belonging to another, and so we must specify the group membership of the samples. We do this using the <code><a href="../reference/group_designation.html">group_designation()</a></code> function, which modifies our pepData object and returns an updated version of it. Up to two main effects and up to two covariates may be specified, with one main effect being required at minimum. For the example data, we only have one option - specify the main effect to be “Condition” - since we do not have any additional information about the samples. Certain functions we will use below require that groups have been designated via the <code><a href="../reference/group_designation.html">group_designation()</a></code> function.</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mypepData</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/group_designation.html">group_designation</a></span><span class="op">(</span><span class="va">mypepData</span>, main_effects <span class="op">=</span> <span class="st">"Condition"</span>, covariates <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div>
<p>The <code><a href="../reference/group_designation.html">group_designation()</a></code> function creates an attribute of the dataset as follows:</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/attributes.html" class="external-link">attributes</a></span><span class="op">(</span><span class="va">mypepData</span><span class="op">)</span><span class="op">$</span><span class="va">group_DF</span></span></code></pre></div>
<pre><code><span><span class="co">##      SampleID     Group</span></span>
<span><span class="co">## 1  Infection1 Infection</span></span>
<span><span class="co">## 2  Infection2 Infection</span></span>
<span><span class="co">## 3  Infection3 Infection</span></span>
<span><span class="co">## 4  Infection4 Infection</span></span>
<span><span class="co">## 5  Infection5 Infection</span></span>
<span><span class="co">## 6  Infection6 Infection</span></span>
<span><span class="co">## 7  Infection7 Infection</span></span>
<span><span class="co">## 8  Infection8 Infection</span></span>
<span><span class="co">## 9  Infection9 Infection</span></span>
<span><span class="co">## 10      Mock1      Mock</span></span>
<span><span class="co">## 11      Mock2      Mock</span></span>
<span><span class="co">## 12      Mock3      Mock</span></span></code></pre>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mypepData</span>, color_by <span class="op">=</span> <span class="st">"Condition"</span>, bw_theme<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="Quality_Control_with_pmartR_files/figure-html/format4-1.png" width="768"></p>
</div>
<div class="section level3">
<h3 id="filter-peptides">Filter Peptides<a class="anchor" aria-label="anchor" href="#filter-peptides"></a>
</h3>
<p>It is often good practice to filter out peptides that do not meet certain criteria, and we offer 5 different filters. Each of the filtering functions calculates metric(s) that can be used to filter out peptides and returns an S3 object. Using the <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> function produces a summary of the metric(s) and using the <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> function produces a graph. Filters that require a user-specified threshold in order to actually filter out peptides have corresponding <code>summary</code> and <code>plot</code> methods that take optional argument(s) to specify that threshold. Once one of the 5 peptide level filter functions has been called, the results of that function can be used in conjunction with the <code><a href="../reference/applyFilt.html">applyFilt()</a></code> function to actually filter out peptides based on the metric(s) and user-specified threshold(s) and create a new, filtered pepData object.</p>
<div class="section level4">
<h4 id="proteomics-filter">Proteomics Filter<a class="anchor" aria-label="anchor" href="#proteomics-filter"></a>
</h4>
<p>The proteomics filter is applicable only to peptide level data that contains the <code>e_meta</code> component, as it counts the number of peptides that map to each protein and/or the number of proteins to which each individual peptide maps. It returns a list of two character vectors, the first, <code>peptides_filt</code>, giving degenerate peptide names. The second, <code>proteins_filt</code>, gives the names of proteins which no longer have peptides mapping to them in the dataset. This filter does not require a user-specified threshold.</p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">myfilter</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/proteomics_filter.html">proteomics_filter</a></span><span class="op">(</span><span class="va">mypepData</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">myfilter</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Summary of Proteomics Filter </span></span>
<span><span class="co">## </span></span>
<span><span class="co">##              Obs Proteins Per Peptide Obs Peptides Per Protein</span></span>
<span><span class="co">## Min.                                1                        1</span></span>
<span><span class="co">## 1st Qu.                             1                        1</span></span>
<span><span class="co">## Median                              1                        3</span></span>
<span><span class="co">## Mean                                1         6.27505407354001</span></span>
<span><span class="co">## 3rd Qu.                             1                        7</span></span>
<span><span class="co">## Max.                                1                      333</span></span>
<span><span class="co">##                                                               </span></span>
<span><span class="co">## Filtered                            0                        0</span></span>
<span><span class="co">## Not Filtered                    17407                     2774</span></span></code></pre>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">myfilter</span>, bw_theme<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="Quality_Control_with_pmartR_files/figure-html/proteomics_filter-1.png" width="768"></p>
<p>With the current dataset, the majority of proteins have one peptide mapping to them (graph on the left) and all peptides map to a single protein (e.g. no degenerate peptides; graph on the right).</p>
</div>
<div class="section level4">
<h4 id="molecule-filter">Molecule Filter<a class="anchor" aria-label="anchor" href="#molecule-filter"></a>
</h4>
<p>The molecule filter allows the user to remove from the dataset any biomolecule not seen in at least <code>min_num</code> of the samples. The user may specify a threshold of the minimum number of times each biomolecule must be observed across all samples; the default value is 2.</p>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">myfilter</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/molecule_filter.html">molecule_filter</a></span><span class="op">(</span><span class="va">mypepData</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">myfilter</span>, bw_them <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="Quality_Control_with_pmartR_files/figure-html/molecule_filter-1.png" width="768"></p>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">myfilter</span>, min_num <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Summary of Molecule Filter </span></span>
<span><span class="co">## ----------------------------------</span></span>
<span><span class="co">## Minimum Number:3</span></span>
<span><span class="co">## Filtered:3342</span></span>
<span><span class="co">## Not Filtered:14065</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##  num_observations frequency_counts</span></span>
<span><span class="co">##                 1             1814</span></span>
<span><span class="co">##                 2             3342</span></span>
<span><span class="co">##                 3             4911</span></span>
<span><span class="co">##                 4             5934</span></span>
<span><span class="co">##                 5             6737</span></span>
<span><span class="co">##                 6             7530</span></span>
<span><span class="co">##                 7             8389</span></span>
<span><span class="co">##                 8             9279</span></span>
<span><span class="co">##                 9            10383</span></span>
<span><span class="co">##                10            11527</span></span>
<span><span class="co">##                11            12987</span></span>
<span><span class="co">##                12            17407</span></span></code></pre>
<p>Setting the threshold to 3, we would filter 3,342 peptides out of the dataset. If we’d like to make the filter less stringent, we could use a threshold of 2 and only filter 1,872 peptides.</p>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">myfilter</span>, min_num <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Summary of Molecule Filter </span></span>
<span><span class="co">## ----------------------------------</span></span>
<span><span class="co">## Minimum Number:2</span></span>
<span><span class="co">## Filtered:1814</span></span>
<span><span class="co">## Not Filtered:15593</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##  num_observations frequency_counts</span></span>
<span><span class="co">##                 1             1814</span></span>
<span><span class="co">##                 2             3342</span></span>
<span><span class="co">##                 3             4911</span></span>
<span><span class="co">##                 4             5934</span></span>
<span><span class="co">##                 5             6737</span></span>
<span><span class="co">##                 6             7530</span></span>
<span><span class="co">##                 7             8389</span></span>
<span><span class="co">##                 8             9279</span></span>
<span><span class="co">##                 9            10383</span></span>
<span><span class="co">##                10            11527</span></span>
<span><span class="co">##                11            12987</span></span>
<span><span class="co">##                12            17407</span></span></code></pre>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#plot(myfilter, min_num = 2)</span></span>
<span></span>
<span><span class="va">mypepData</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/applyFilt.html">applyFilt</a></span><span class="op">(</span>filter_object <span class="op">=</span> <span class="va">myfilter</span>, <span class="va">mypepData</span>, min_num <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mypepData</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##                                     </span></span>
<span><span class="co">## Class                        pepData</span></span>
<span><span class="co">## Unique SampleIDs (f_data)         12</span></span>
<span><span class="co">## Unique Mass_Tag_IDs (e_data)   15593</span></span>
<span><span class="co">## Unique Proteins (e_meta)        2511</span></span>
<span><span class="co">## Missing Observations           62879</span></span>
<span><span class="co">## Proportion Missing             0.336</span></span>
<span><span class="co">## Samples per group: Infection       9</span></span>
<span><span class="co">## Samples per group: Mock            3</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="coefficient-of-variation-filter">Coefficient of Variation Filter<a class="anchor" aria-label="anchor" href="#coefficient-of-variation-filter"></a>
</h4>
<p>The coefficient of variation (CV) filter calculates the pooled CV values as in <span class="citation">(Ahmed 1995)</span>.</p>
<p>The user can then specify a CV threshold, above which peptides are removed.</p>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">myfilter</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cv_filter.html">cv_filter</a></span><span class="op">(</span><span class="va">mypepData</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">myfilter</span>, cv_threshold <span class="op">=</span> <span class="fl">150</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Summary of Coefficient of Variation (CV) Filter</span></span>
<span><span class="co">## ----------------------</span></span>
<span><span class="co">## CVs:</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##      Min.   1st Qu.    Median      Mean   3rd Qu.      Max. </span></span>
<span><span class="co">##   0.04778  24.85999  32.28337  34.83979  42.00244 168.69275 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Total NAs: 359</span></span>
<span><span class="co">## Total Non-NAs: 15234 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Number Filtered Biomolecules: 2</span></span></code></pre>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">myfilter</span>, cv_threshold <span class="op">=</span> <span class="fl">150</span>, title_lab_size <span class="op">=</span> <span class="fl">15</span><span class="op">)</span></span></code></pre></div>
<p><img src="Quality_Control_with_pmartR_files/figure-html/cv_filter-1.png" width="768"></p>
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mypepData</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/applyFilt.html">applyFilt</a></span><span class="op">(</span>filter_object <span class="op">=</span> <span class="va">myfilter</span>, <span class="va">mypepData</span>, cv_threshold <span class="op">=</span> <span class="fl">150</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mypepData</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##                                     </span></span>
<span><span class="co">## Class                        pepData</span></span>
<span><span class="co">## Unique SampleIDs (f_data)         12</span></span>
<span><span class="co">## Unique Mass_Tag_IDs (e_data)   15591</span></span>
<span><span class="co">## Unique Proteins (e_meta)        2511</span></span>
<span><span class="co">## Missing Observations           62871</span></span>
<span><span class="co">## Proportion Missing             0.336</span></span>
<span><span class="co">## Samples per group: Infection       9</span></span>
<span><span class="co">## Samples per group: Mock            3</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="custom-filter">Custom Filter<a class="anchor" aria-label="anchor" href="#custom-filter"></a>
</h4>
<p>Sometimes it is known a priori that certain peptides or samples should be filtered out of the dataset prior to statistical analysis. Perhaps there are known contaminant proteins, and so peptides mapping to them should be removed, or perhaps something went wrong during sample preparation for a particular sample. On the other hand, it may be preferred to specify peptides or samples to keep (removing those not explicitly specified), and this can also be accomplished. Keep in mind that both ‘remove’ and ‘keep’ arguments cannot be specified together; either ‘remove’ arguments only or ‘keep’ arguments only may be specified in a single call to custom_filter().</p>
<p>Here, we demonstrate the removal of the peptide with Mass Tag ID 1047 and sample <code>Infection 1</code> as an example.</p>
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">myfilter</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/custom_filter.html">custom_filter</a></span><span class="op">(</span><span class="va">mypepData</span>, e_data_remove <span class="op">=</span> <span class="fl">1047</span>, e_meta_remove <span class="op">=</span> <span class="cn">NULL</span>, f_data_remove <span class="op">=</span> <span class="st">"Infection1"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">myfilter</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Summary of Custom Filter</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##                       Filtered Remaining Total</span></span>
<span><span class="co">## SampleIDs (f_data)           1        11    12</span></span>
<span><span class="co">## Mass_Tag_IDs (e_data)        1     15590 15591</span></span>
<span><span class="co">## Proteins (e_meta)            0      2511  2511</span></span></code></pre>
<div class="sourceCode" id="cb59"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mypepData_temp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/applyFilt.html">applyFilt</a></span><span class="op">(</span>filter_object <span class="op">=</span> <span class="va">myfilter</span>, <span class="va">mypepData</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mypepData_temp</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##                                     </span></span>
<span><span class="co">## Class                        pepData</span></span>
<span><span class="co">## Unique SampleIDs (f_data)         11</span></span>
<span><span class="co">## Unique Mass_Tag_IDs (e_data)   15590</span></span>
<span><span class="co">## Unique Proteins (e_meta)        2511</span></span>
<span><span class="co">## Missing Observations           58431</span></span>
<span><span class="co">## Proportion Missing             0.341</span></span>
<span><span class="co">## Samples per group: Infection       8</span></span>
<span><span class="co">## Samples per group: Mock            3</span></span></code></pre>
<div class="sourceCode" id="cb61"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span><span class="va">mypepData_temp</span><span class="op">)</span></span></code></pre></div>
<p>We also demonstrate how to use this filter with the ‘keep’ option by keeping the samples <code>Infection 1</code>, <code>Infection 2</code>, <code>Infection 3</code>, <code>Infection 4</code> and <code>Infection 5</code>.</p>
<div class="sourceCode" id="cb62"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">myfilter2</span><span class="op">&lt;-</span> <span class="fu"><a href="../reference/custom_filter.html">custom_filter</a></span><span class="op">(</span><span class="va">mypepData</span>, e_data_keep <span class="op">=</span> <span class="cn">NULL</span>, e_meta_keep <span class="op">=</span> <span class="cn">NULL</span>, f_data_keep <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Infection1"</span>, <span class="st">"Infection2"</span>, <span class="st">"Infection3"</span>, <span class="st">"Infection4"</span>, <span class="st">"Infection5"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">myfilter2</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Summary of Custom Filter</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##                       Discarded  Kept Total</span></span>
<span><span class="co">## SampleIDs (f_data)            7     5    12</span></span>
<span><span class="co">## Mass_Tag_IDs (e_data)         0 15591 15591</span></span>
<span><span class="co">## Proteins (e_meta)             0  2511  2511</span></span></code></pre>
<div class="sourceCode" id="cb64"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mypepData_temp2</span><span class="op">&lt;-</span> <span class="fu"><a href="../reference/applyFilt.html">applyFilt</a></span><span class="op">(</span>filter_object <span class="op">=</span> <span class="va">myfilter2</span>, <span class="va">mypepData</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mypepData_temp2</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##                                     </span></span>
<span><span class="co">## Class                        pepData</span></span>
<span><span class="co">## Unique SampleIDs (f_data)          5</span></span>
<span><span class="co">## Unique Mass_Tag_IDs (e_data)   15591</span></span>
<span><span class="co">## Unique Proteins (e_meta)        2511</span></span>
<span><span class="co">## Missing Observations           25005</span></span>
<span><span class="co">## Proportion Missing             0.321</span></span>
<span><span class="co">## Samples per group: Infection       5</span></span></code></pre>
<div class="sourceCode" id="cb66"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span><span class="va">mypepData_temp2</span><span class="op">)</span></span></code></pre></div>
<p>Note that there is a <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> method for objects of type custom_filt, but no <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> method.</p>
</div>
<div class="section level4">
<h4 id="imd-anova-filter">IMD-ANOVA Filter<a class="anchor" aria-label="anchor" href="#imd-anova-filter"></a>
</h4>
<p>The IMD-ANOVA filter removes peptides that do not have sufficient data for the statistical tests available in the pmartRstat package; these are ANOVA (quantitative test) and an independence of missing data (IMD) using a g-test (qualitative test). When using the <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code>, <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code>, and <code><a href="../reference/applyFilt.html">applyFilt()</a></code> functions, you can specify just one filter (ANOVA or IMD) or both, depending on the tests you’d like to perform later. Using this filter speeds up the process of performing the statistical tests.</p>
<div class="sourceCode" id="cb67"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">myfilter</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/imdanova_filter.html">imdanova_filter</a></span><span class="op">(</span><span class="va">mypepData</span><span class="op">)</span></span></code></pre></div>
<p>Here we consider what the filter would look like for both ANOVA and IMD.</p>
<div class="sourceCode" id="cb68"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">myfilter</span>, min_nonmiss_anova <span class="op">=</span> <span class="fl">2</span>, min_nonmiss_gtest <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Summary of IMD Filter</span></span>
<span><span class="co">##                           </span></span>
<span><span class="co">## Total Observations:  15591</span></span>
<span><span class="co">## Filtered:             2052</span></span>
<span><span class="co">## Not Filtered:        13539</span></span></code></pre>
<div class="sourceCode" id="cb70"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#plot(myfilter, min_nonmiss_anova = 2, min_nonmiss_gtest = 3)</span></span></code></pre></div>
<p>Here we consider what the filter would look like for just ANOVA.</p>
<div class="sourceCode" id="cb71"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">myfilter</span>, min_nonmiss_anova <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Summary of IMD Filter</span></span>
<span><span class="co">##                           </span></span>
<span><span class="co">## Total Observations:  15591</span></span>
<span><span class="co">## Filtered:             5511</span></span>
<span><span class="co">## Not Filtered:        10080</span></span></code></pre>
<div class="sourceCode" id="cb73"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#plot(myfilter, min_nonmiss_anova = 2)</span></span></code></pre></div>
<p>Here we consider what the filter would look like for just IMD.</p>
<div class="sourceCode" id="cb74"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">myfilter</span>, min_nonmiss_gtest <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Summary of IMD Filter</span></span>
<span><span class="co">##                           </span></span>
<span><span class="co">## Total Observations:  15591</span></span>
<span><span class="co">## Filtered:             2280</span></span>
<span><span class="co">## Not Filtered:        13311</span></span></code></pre>
<div class="sourceCode" id="cb76"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#plot(myfilter, min_nonmiss_gtest = 3)</span></span></code></pre></div>
<p>Now we apply the filter for both ANOVA and IMD.</p>
<div class="sourceCode" id="cb77"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mypepData</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/applyFilt.html">applyFilt</a></span><span class="op">(</span>filter_object <span class="op">=</span> <span class="va">myfilter</span>, <span class="va">mypepData</span>, min_nonmiss_anova <span class="op">=</span> <span class="fl">2</span>, min_nonmiss_gtest <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## You have specified remove_singleton_groups = TRUE, but there are no singleton groups to remove. Proceeding with application of the IMD-ANOVA filter.</span></span></code></pre>
<div class="sourceCode" id="cb79"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mypepData</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##                                     </span></span>
<span><span class="co">## Class                        pepData</span></span>
<span><span class="co">## Unique SampleIDs (f_data)         12</span></span>
<span><span class="co">## Unique Mass_Tag_IDs (e_data)   13539</span></span>
<span><span class="co">## Unique Proteins (e_meta)        2253</span></span>
<span><span class="co">## Missing Observations           42875</span></span>
<span><span class="co">## Proportion Missing             0.264</span></span>
<span><span class="co">## Samples per group: Infection       9</span></span>
<span><span class="co">## Samples per group: Mock            3</span></span></code></pre>
</div>
</div>
<div class="section level3">
<h3 id="filter-samples">Filter Samples<a class="anchor" aria-label="anchor" href="#filter-samples"></a>
</h3>
<p>To identify any samples that are potential outliers or anomalies (due to sample quality, preparation, or processing circumstances), we use a robust Mahalanobis distance (rMd) <span class="citation">(Matzke et al. 2011)</span> score based on 2-5 metrics. The possible metrics are:</p>
<ul>
<li><p>Correlation</p></li>
<li><p>Proportion of data that is missing (“Proportion_Missing”)</p></li>
<li><p>Median absolute deviation (“MAD”)</p></li>
<li><p>Skewness</p></li>
<li><p>Kurtosis</p></li>
</ul>
<p>The rMd score can be mapped to a p-value, and a p-value threshold used to identify potentially outlying samples. In general, for proteomics data we recommend using correlation, proportion missing, MAD, and skew. A plot of the rMd values for each sample is generated, and specifying a value for ‘pvalue_threshold’ results in a horizontal line on the plot, with samples above the line slated for filtering at the given threshold.</p>
<div class="sourceCode" id="cb81"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">myfilter</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rmd_filter.html">rmd_filter</a></span><span class="op">(</span><span class="va">mypepData</span>, metrics <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Correlation"</span>, <span class="st">"Proportion_Missing"</span>, <span class="st">"MAD"</span>, <span class="st">"Skewness"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">myfilter</span>, bw_theme<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="Quality_Control_with_pmartR_files/figure-html/rmd1-1.png" width="768"></p>
<div class="sourceCode" id="cb82"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">myfilter</span>, pvalue_threshold <span class="op">=</span> <span class="fl">0.001</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Summary of RMD Filter</span></span>
<span><span class="co">## ----------------------</span></span>
<span><span class="co">## P-values:</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##      Min.   1st Qu.    Median      Mean   3rd Qu.      Max. </span></span>
<span><span class="co">## 0.0000001 0.2686711 0.4152817 0.5050117 0.8306939 0.9707249 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Metrics Used: MAD, Skewness, Corr, Proportion_Missing </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Filtered Samples: Infection5, Infection8</span></span></code></pre>
<div class="sourceCode" id="cb84"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">myfilter</span>, pvalue_threshold <span class="op">=</span> <span class="fl">0.001</span>, bw_theme<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="Quality_Control_with_pmartR_files/figure-html/rmd1-2.png" width="768"></p>
<p>Using the output from the <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> function, we can explore the outliers identified to see what metrics are driving their outlier-ness. Box plots for each metric are graphed, with the specified sample marked with an ‘X’.</p>
<div class="sourceCode" id="cb85"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">myfilter</span>, sampleID <span class="op">=</span> <span class="st">"Infection5"</span>, bw_theme<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="Quality_Control_with_pmartR_files/figure-html/rmd2-1.png" width="768"></p>
<div class="sourceCode" id="cb86"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">myfilter</span>, sampleID <span class="op">=</span> <span class="st">"Infection8"</span>, bw_theme<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="Quality_Control_with_pmartR_files/figure-html/rmd2-2.png" width="768"></p>
<p>We can see that Infection5 has the highest MAD, low skewness, and almost the lowest correlation, but the lowest proportion missing compared to the other samples. Infection 8 has MAD close to the median MAD value, the highest skew, the lowest correlation, and the highest proportion of missing data. We can use this information to determine whether to remove either or both of these samples. Sometimes it is also useful to look at additional data summaries to inform outlier removal, such as a principal components plot or correlation heat map (below).</p>
</div>
<div class="section level3">
<h3 id="normalize-data">Normalize Data<a class="anchor" aria-label="anchor" href="#normalize-data"></a>
</h3>
<p>The next step in a typical workflow is to normalize the data.</p>
<p>Normalization approaches consist of a subset method and a normalization function <span class="citation">(Åstrand 2003)</span>,<span class="citation">(Gautier et al. 2004)</span>. Available subset methods include:</p>
<ul>
<li><p>Percentage of peptides present (PPP): Subset the data to peptides present in at least <span class="math inline">\(p\)</span> percent of samples. This subset method is specified as “ppp”.</p></li>
<li><p>Rank invariant peptides (RIP): First subset peptides to those present in every sample (e.g. complete peptides). Next, subject each peptide to a Kruskal Wallis test on group, and those peptides <em>not</em> significant at a given p-value threshold are retained as invariant. This subset method is specified as “rip”.</p></li>
<li><p>PPP-RIP: Rank invariant peptides among peptides present in a given percentage of samples. This subset method is specified as “ppp_rip”.</p></li>
<li><p>Top “l” order statistics (LOS): The peptides with intensities in the top “l” order statistics are retained. This subset method is specified as “los”.</p></li>
</ul>
<p>Available normalization functions include:</p>
<ul>
<li><p>Median centering: The sample-wise median (median of all peptides in a given sample) is subtracted from each peptide in the corresponding sample. This normalization method is specified as “median”.</p></li>
<li><p>Mean centering: The sample-wise mean (mean of all peptides in a given sample) is subtracted from each peptide in the corresponding sample. This normalization method is specified as “mean”.</p></li>
<li><p>Z-score transformation: The sample-wise mean (mean of all peptides in a given sample) is subtracted from each peptide, and the result is divided by the sample-wise standard deviation (standard deviation of all peptides in a given sample) in the corresponding sample. This normalization method is specified as “zscore”.</p></li>
<li><p>Median absolute deviation (MAD) transformation: The sample-wise median (median of all peptides in a given sample) is subtracted from each peptide, and the result is divided by the sample-wise MAD (MAD of all peptides in a given sample) in the corresponding sample. This normalization method is specified as “mad”.</p></li>
</ul>
<p>There are two ways to go about normalizing data in the pmartR package. If you know the normalization approach you’d like to use, you can directly specify it in the <code>normalize_data()</code> function. Or, if you want to see how compatible different normalization approaches are with your dataset, you can use the <code><a href="../reference/spans_procedure.html">spans_procedure()</a></code> function.</p>
<p>We can go straight to the normalization, if we know what approach we want to use.</p>
<div class="sourceCode" id="cb87"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Normalize using all peptides and median centering #</span></span>
<span><span class="va">norm_object</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/normalize_global.html">normalize_global</a></span><span class="op">(</span>omicsData <span class="op">=</span> <span class="va">mypepData</span>, subset_fn <span class="op">=</span> <span class="st">"all"</span>, norm_fn <span class="op">=</span> <span class="st">"median"</span>, apply_norm <span class="op">=</span> <span class="cn">FALSE</span>, backtransform <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">norm_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/normalize_global.html">normalize_global</a></span><span class="op">(</span>omicsData <span class="op">=</span> <span class="va">mypepData</span>, subset_fn <span class="op">=</span> <span class="st">"all"</span>, norm_fn <span class="op">=</span> <span class="st">"median"</span>, apply_norm <span class="op">=</span> <span class="cn">TRUE</span>, backtransform <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">norm_data</span>, title_lab<span class="op">=</span><span class="st">"Normalized Data: Median Centering Using all Peptides"</span>, title_lab_size<span class="op">=</span><span class="fl">12</span><span class="op">)</span></span></code></pre></div>
<p><img src="Quality_Control_with_pmartR_files/figure-html/norm2-1.png" width="768"></p>
<div class="sourceCode" id="cb88"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Normalize using RIP 0.2 and median centering #</span></span>
<span><span class="va">norm_object</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/normalize_global.html">normalize_global</a></span><span class="op">(</span>omicsData <span class="op">=</span> <span class="va">mypepData</span>, subset_fn <span class="op">=</span> <span class="st">"rip"</span>, params<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>rip<span class="op">=</span><span class="fl">0.2</span><span class="op">)</span>, norm_fn <span class="op">=</span> <span class="st">"median"</span>, apply_norm <span class="op">=</span> <span class="cn">FALSE</span>, backtransform <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">norm_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/normalize_global.html">normalize_global</a></span><span class="op">(</span>omicsData <span class="op">=</span> <span class="va">mypepData</span>, subset_fn <span class="op">=</span> <span class="st">"rip"</span>, params<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>rip<span class="op">=</span><span class="fl">0.2</span><span class="op">)</span>, norm_fn <span class="op">=</span> <span class="st">"median"</span>, apply_norm <span class="op">=</span> <span class="cn">TRUE</span>, backtransform <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">norm_data</span>, title_lab<span class="op">=</span><span class="st">"Normalized Data: Median Centering Using RIP 0.2 Peptides"</span>, title_lab_size<span class="op">=</span><span class="fl">12</span><span class="op">)</span></span></code></pre></div>
<p><img src="Quality_Control_with_pmartR_files/figure-html/norm2-2.png" width="768"></p>
<p>Below we use SPANS to select a normalization approach and then normalize the data.</p>
<div class="sourceCode" id="cb89"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># returns a dataframe arranged by descending SPANS score</span></span>
<span><span class="va">spans_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/spans_procedure.html">spans_procedure</a></span><span class="op">(</span><span class="va">mypepData</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "Finished creating background distribution, moving to method candidate selection"</span></span>
<span><span class="co">## [1] "Finished method candidate selection, proceeding to score selected methods."</span></span>
<span><span class="co">## [1] "Finished scoring selected methods"</span></span></code></pre>
<div class="sourceCode" id="cb91"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">spans_result</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Summary of spans procedure</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Highest ranked method(s)</span></span>
<span><span class="co">##   subset_method normalization_method SPANS_score parameters mols_used_in_norm</span></span>
<span><span class="co">## 1           rip               median           1        0.1              1554</span></span>
<span><span class="co">## 2           rip               median           1       0.15              1369</span></span>
<span><span class="co">## 3           rip               median           1        0.2              1158</span></span>
<span><span class="co">## 4           rip               median           1       0.25               987</span></span>
<span><span class="co">## 5       ppp_rip               median           1    0.1;0.1              3195</span></span>
<span><span class="co">## 6       ppp_rip               median           1  0.25;0.15              3195</span></span>
<span><span class="co">##   passed_selection rank</span></span>
<span><span class="co">## 1             TRUE    1</span></span>
<span><span class="co">## 2             TRUE    1</span></span>
<span><span class="co">## 3             TRUE    1</span></span>
<span><span class="co">## 4             TRUE    1</span></span>
<span><span class="co">## 5             TRUE    1</span></span>
<span><span class="co">## 6             TRUE    1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Number of input methods:  68</span></span>
<span><span class="co">## Number of methods scored:  30</span></span>
<span><span class="co">## Average molecules used in normalization:  5277</span></span></code></pre>
<div class="sourceCode" id="cb93"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">spans_result</span><span class="op">)</span></span></code></pre></div>
<p><img src="Quality_Control_with_pmartR_files/figure-html/spans_plot_summarize-1.png" width="768"></p>
<div class="sourceCode" id="cb94"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># a list of the parameters for any normalization procedure with the best SPANS score</span></span>
<span><span class="va">best_params</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_spans_params.html">get_spans_params</a></span><span class="op">(</span><span class="va">spans_result</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># there are a few ties, all using ppp_rip, well select the method that uses median normalization and parameters ppp = 0.1 and rip = 0.1</span></span>
<span><span class="va">subset_fn</span> <span class="op">=</span> <span class="va">best_params</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">subset_fn</span></span>
<span><span class="va">norm_fn</span> <span class="op">=</span> <span class="va">best_params</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">norm_fn</span></span>
<span><span class="va">params</span> <span class="op">=</span> <span class="va">best_params</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">params</span></span>
<span></span>
<span><span class="co"># we now pass the extracted subset function, normalization function, and parameters from SPANS to normalize_global()</span></span>
<span><span class="va">norm_object</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/normalize_global.html">normalize_global</a></span><span class="op">(</span>omicsData <span class="op">=</span> <span class="va">mypepData</span>, subset_fn <span class="op">=</span> <span class="va">subset_fn</span>, norm_fn <span class="op">=</span> <span class="va">norm_fn</span>, params <span class="op">=</span> <span class="va">params</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="summarize-data">Summarize Data<a class="anchor" aria-label="anchor" href="#summarize-data"></a>
</h3>
<p>The pmartR package contains various methods for data summarization and exploration that can be used as part of the QC process: numeric summaries and associated plots (via the <code><a href="../reference/edata_summary.html">edata_summary()</a></code> function), sequential projection pursuit principal components analysis (sppPCA) for dimension reduction (via the<code><a href="../reference/dim_reduction.html">dim_reduction()</a></code> function), and a correlation heat map (via the <code><a href="../reference/cor_result.html">cor_result()</a></code> function)<span class="citation">(Stacklies et al. 2007)</span>. As for missing data summarization there are also functions to collect and plot missing data information. Missing data collection and plotting functions include, <code><a href="../reference/missingval_result.html">missingval_result()</a></code>, <code>plot_missingval()</code>, <code>missingval_scatterplot()</code> and <code>missingval_heatmap()</code>.</p>
<div class="section level4">
<h4 id="numeric-summaries">Numeric Summaries<a class="anchor" aria-label="anchor" href="#numeric-summaries"></a>
</h4>
<p>We can generate numeric summaries of our data by either sample or molecule. The <code><a href="../reference/edata_summary.html">edata_summary()</a></code> function computes the mean, standard deviation, median, percent of observations for which a value was observed, the minimum value, and the maximum value.</p>
<div class="sourceCode" id="cb95"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/edata_summary.html">edata_summary</a></span><span class="op">(</span>omicsData <span class="op">=</span> <span class="va">norm_data</span>, by <span class="op">=</span> <span class="st">"sample"</span>, groupvar <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## mean</span></span>
<span><span class="co">##        sample             mean</span></span>
<span><span class="co">## 1  Infection1 21.7971083294077</span></span>
<span><span class="co">## 2  Infection2  21.731366523126</span></span>
<span><span class="co">## 3  Infection3 21.8032232443703</span></span>
<span><span class="co">## 4  Infection4 21.8774087539977</span></span>
<span><span class="co">## 5  Infection5 21.4257258525994</span></span>
<span><span class="co">## 6        ----             ----</span></span>
<span><span class="co">## 8  Infection8 22.4709412800765</span></span>
<span><span class="co">## 9  Infection9  22.179932218701</span></span>
<span><span class="co">## 10      Mock1 22.5630135430607</span></span>
<span><span class="co">## 11      Mock2 22.4045599582422</span></span>
<span><span class="co">## 12      Mock3  22.350225943675</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## std_dev</span></span>
<span><span class="co">##        sample               sd</span></span>
<span><span class="co">## 1  Infection1 2.41455648093841</span></span>
<span><span class="co">## 2  Infection2 2.31224701980782</span></span>
<span><span class="co">## 3  Infection3 2.35043331396441</span></span>
<span><span class="co">## 4  Infection4 2.44617068574648</span></span>
<span><span class="co">## 5  Infection5  2.5535287332081</span></span>
<span><span class="co">## 6        ----             ----</span></span>
<span><span class="co">## 8  Infection8 2.26180598552078</span></span>
<span><span class="co">## 9  Infection9 2.36212527529442</span></span>
<span><span class="co">## 10      Mock1 2.28423295890622</span></span>
<span><span class="co">## 11      Mock2 2.18183571765243</span></span>
<span><span class="co">## 12      Mock3 2.28027627057377</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## median</span></span>
<span><span class="co">##        sample           median</span></span>
<span><span class="co">## 1  Infection1 21.7706905193056</span></span>
<span><span class="co">## 2  Infection2 21.6715407709563</span></span>
<span><span class="co">## 3  Infection3 21.7490538629397</span></span>
<span><span class="co">## 4  Infection4 21.8551805308581</span></span>
<span><span class="co">## 5  Infection5  21.465407352971</span></span>
<span><span class="co">## 6        ----             ----</span></span>
<span><span class="co">## 8  Infection8 22.4154539852953</span></span>
<span><span class="co">## 9  Infection9  22.122666472151</span></span>
<span><span class="co">## 10      Mock1 22.5353174031891</span></span>
<span><span class="co">## 11      Mock2 22.3226552138985</span></span>
<span><span class="co">## 12      Mock3 22.3085808857998</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## pct_obs</span></span>
<span><span class="co">##        sample           pct_obs</span></span>
<span><span class="co">## 1  Infection1 0.796513775020312</span></span>
<span><span class="co">## 2  Infection2 0.790014033532757</span></span>
<span><span class="co">## 3  Infection3 0.730334588965212</span></span>
<span><span class="co">## 4  Infection4 0.691705443533496</span></span>
<span><span class="co">## 5  Infection5 0.802348770219366</span></span>
<span><span class="co">## 6        ----              ----</span></span>
<span><span class="co">## 8  Infection8 0.529359627742078</span></span>
<span><span class="co">## 9  Infection9 0.611123421227565</span></span>
<span><span class="co">## 10      Mock1 0.789940172834035</span></span>
<span><span class="co">## 11      Mock2 0.796661496417756</span></span>
<span><span class="co">## 12      Mock3 0.799098899475589</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## minimum</span></span>
<span><span class="co">##        sample              min</span></span>
<span><span class="co">## 1  Infection1 12.1066097831752</span></span>
<span><span class="co">## 2  Infection2 12.3753923747856</span></span>
<span><span class="co">## 3  Infection3 13.4885281669697</span></span>
<span><span class="co">## 4  Infection4 12.2536652266729</span></span>
<span><span class="co">## 5  Infection5  11.026508295961</span></span>
<span><span class="co">## 6        ----             ----</span></span>
<span><span class="co">## 8  Infection8 14.3702269404971</span></span>
<span><span class="co">## 9  Infection9 13.4319078573245</span></span>
<span><span class="co">## 10      Mock1 13.0850982141284</span></span>
<span><span class="co">## 11      Mock2 13.6650934960137</span></span>
<span><span class="co">## 12      Mock3 11.6186174442457</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## maximum</span></span>
<span><span class="co">##        sample              max</span></span>
<span><span class="co">## 1  Infection1 30.9532147548287</span></span>
<span><span class="co">## 2  Infection2 30.7628477282651</span></span>
<span><span class="co">## 3  Infection3 30.8984015884978</span></span>
<span><span class="co">## 4  Infection4 31.2420886871443</span></span>
<span><span class="co">## 5  Infection5 30.9490717160277</span></span>
<span><span class="co">## 6        ----             ----</span></span>
<span><span class="co">## 8  Infection8 32.3710788536963</span></span>
<span><span class="co">## 9  Infection9 32.1531258831469</span></span>
<span><span class="co">## 10      Mock1  31.275411454618</span></span>
<span><span class="co">## 11      Mock2 31.2032188575782</span></span>
<span><span class="co">## 12      Mock3 31.1871443967351</span></span></code></pre>
<div class="sourceCode" id="cb97"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#edata_summary(omicsData = norm_data, by = "molecule", groupvar = "Condition")</span></span>
<span><span class="co">#edata_summary(omicsData = norm_data, by = "molecule", groupvar = NULL)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="probabilistic-principal-components-analysis">Probabilistic Principal Components Analysis<a class="anchor" aria-label="anchor" href="#probabilistic-principal-components-analysis"></a>
</h4>
<p>Probabilistic is a PCA algorithm that can be used in the presence of missing data. We use the <code><a href="../reference/dim_reduction.html">dim_reduction()</a></code> function in pmartR, specifying the dataset and the number of principal components to return (default value of 2 principal components). The <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> and <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> functions operate on the results of the <code><a href="../reference/dim_reduction.html">dim_reduction()</a></code> function.</p>
<p>Note that <code><a href="../reference/dim_reduction.html">dim_reduction()</a></code> requires that the <code><a href="../reference/group_designation.html">group_designation()</a></code> function has been run.</p>
<div class="sourceCode" id="cb98"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pca_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dim_reduction.html">dim_reduction</a></span><span class="op">(</span><span class="va">norm_data</span>, k <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">pca_results</span><span class="op">)</span> </span></code></pre></div>
<pre><code><span><span class="co">## Summary of 'dimRes' Object</span></span></code></pre>
<pre><code><span><span class="co">##     R_squaredPC1     0.532PC2     0.336</span></span></code></pre>
<div class="sourceCode" id="cb101"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">pca_results</span>, bw_theme<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="Quality_Control_with_pmartR_files/figure-html/sppPCA-1.png" width="768"></p>
</div>
<div class="section level4">
<h4 id="correlation-heatmap">Correlation Heatmap<a class="anchor" aria-label="anchor" href="#correlation-heatmap"></a>
</h4>
<p>Pearson correlation between samples is calculated based on pairwise complete biomolecules.</p>
<div class="sourceCode" id="cb102"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">correlation_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cor_result.html">cor_result</a></span><span class="op">(</span><span class="va">norm_data</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">correlation_results</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Summary of Correlation Matrix (Upper Triangle)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span><span class="co">##  0.7804  0.8688  0.9143  0.9032  0.9496  0.9722</span></span></code></pre>
<div class="sourceCode" id="cb104"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">correlation_results</span><span class="op">)</span></span></code></pre></div>
<p><img src="Quality_Control_with_pmartR_files/figure-html/corr-1.png" width="768"></p>
</div>
<div class="section level4">
<h4 id="missing-data">Missing Data<a class="anchor" aria-label="anchor" href="#missing-data"></a>
</h4>
<p>Patterns of missing data can be explored using the <code><a href="../reference/missingval_result.html">missingval_result()</a></code> and corresponding <code>plot</code> function.</p>
<div class="sourceCode" id="cb105"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/missingval_result.html">missingval_result</a></span><span class="op">(</span><span class="va">mypepData</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">results</span>, <span class="va">mypepData</span>, plot_type <span class="op">=</span> <span class="st">"bar"</span><span class="op">)</span></span></code></pre></div>
<p><img src="Quality_Control_with_pmartR_files/figure-html/missingval-1.png" width="768"></p>
<div class="sourceCode" id="cb106"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">results</span>, <span class="va">mypepData</span>, plot_type <span class="op">=</span> <span class="st">"scatter"</span><span class="op">)</span></span></code></pre></div>
<p><img src="Quality_Control_with_pmartR_files/figure-html/missingval-2.png" width="768"></p>
</div>
</div>
<div class="section level3">
<h3 id="protein-quantification-methods">Protein Quantification Methods<a class="anchor" aria-label="anchor" href="#protein-quantification-methods"></a>
</h3>
<p>Protein quantification can be done using the <code><a href="../reference/protein_quant.html">protein_quant()</a></code> function, either with or without accounting for different isoforms of the proteins, also called ‘proteoforms’. Regardless of whether the user is accounting for protein isoforms, they must specify a method for rolling peptides up to proteins (one of “rollup”, “rollup”, “qrollup”, or “zrollup”) and a function to use for combining the peptide-level data (either “mean” or “median”). When the user does wish to account for protein isoforms, they have two options for doing so: Bayesian Proteoform Quantification (BP-Quant) <span class="citation">(Webb-Robertson et al. 2014)</span> or Protein Quantification via Peptide Quality-Control (PQPQ).</p>
<p>The <code><a href="../reference/protein_quant.html">protein_quant()</a></code> function returns an object of class proData.</p>
<div class="section level4">
<h4 id="rollup-methods">Rollup Methods<a class="anchor" aria-label="anchor" href="#rollup-methods"></a>
</h4>
<p>The rollup method takes either the mean or median of all peptides mapping to a given protein, and sets that value as the relative protein abundance.</p>
<p>In the rrollup method, all peptides that map to a single protein are scaled based on a chosen reference peptide, which is the peptide with most observations. Next the average or mean of the scaled peptides is set as the relative protein abundance. <span class="citation">(Matzke et al. 2013)</span></p>
<p>The qrollup method starts with all peptides that map to a single protein. Next peptides are chosen according to an abundance cutoff value and the average or mean of the scaled peptides is set as the protein abundance.</p>
<p>In the zrollup method, scaling is done similarly to the z-score formula (except with medians instead of means). The scaling formula is applied to peptides that map to a single protein and then the mean or median of the scaled peptides is set as protein abundance (from DAnTE article). The rollup method is similar to rrollup method, except there is no scaling involved in these methods. Either the mean or median is applied to all peptides that map to a single protein to obtain protein abundance. <span class="citation">(Polpitiya et al. 2008)</span></p>
<div class="sourceCode" id="cb107"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">mypepData</span><span class="op">)</span></span>
<span></span>
<span><span class="va">mypepdata_median</span><span class="op">&lt;-</span> <span class="fu"><a href="../reference/protein_quant.html">protein_quant</a></span><span class="op">(</span>pepData <span class="op">=</span> <span class="va">mypepData</span>, method <span class="op">=</span> <span class="st">"rollup"</span>, combine_fn <span class="op">=</span> <span class="st">"median"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">mypepdata_median</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span><span class="va">mypepdata_median</span><span class="op">)</span></span>
<span></span>
<span><span class="va">mypepdata_rrollup</span><span class="op">&lt;-</span> <span class="fu"><a href="../reference/protein_quant.html">protein_quant</a></span><span class="op">(</span>pepData <span class="op">=</span> <span class="va">mypepData</span>, method <span class="op">=</span> <span class="st">"rrollup"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">mypepdata_rrollup</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span><span class="va">mypepdata_rrollup</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-ahmed1995pooling" class="csl-entry">
Ahmed, SE. 1995. <span>“A Pooling Methodology for Coefficient of Variation.”</span> <em>Sankhy<span>ā</span>: The Indian Journal of Statistics, Series B</em>, 57–75.
</div>
<div id="ref-aastrand2003contrast" class="csl-entry">
Åstrand, Magnus. 2003. <span>“Contrast Normalization of Oligonucleotide Arrays.”</span> <em>Journal of Computational Biology</em> 10 (1): 95–102.
</div>
<div id="ref-gautier2004affy" class="csl-entry">
Gautier, Laurent, Leslie Cope, Benjamin M Bolstad, and Rafael A Irizarry. 2004. <span>“Affy—Analysis of Affymetrix GeneChip Data at the Probe Level.”</span> <em>Bioinformatics</em> 20 (3): 307–15.
</div>
<div id="ref-matzke2013comparative" class="csl-entry">
Matzke, Melissa M, Joseph N Brown, Marina A Gritsenko, Thomas O Metz, Joel G Pounds, Karin D Rodland, Anil K Shukla, et al. 2013. <span>“A Comparative Analysis of Computational Approaches to Relative Protein Quantification Using Peptide Peak Intensities in Label-Free LC-MS Proteomics Experiments.”</span> <em>Proteomics</em> 13 (3-4): 493–503.
</div>
<div id="ref-matzke2011improved" class="csl-entry">
Matzke, Melissa M, Katrina M Waters, Thomas O Metz, Jon M Jacobs, Amy C Sims, Ralph S Baric, Joel G Pounds, and Bobbie-Jo M Webb-Robertson. 2011. <span>“Improved Quality Control Processing of Peptide-Centric LC-MS Proteomics Data.”</span> <em>Bioinformatics</em> 27 (20): 2866–72.
</div>
<div id="ref-polpitiya2008dante" class="csl-entry">
Polpitiya, Ashoka D, Wei-Jun Qian, Navdeep Jaitly, Vladislav A Petyuk, Joshua N Adkins, David G Camp, Gordon A Anderson, and Richard D Smith. 2008. <span>“DAnTE: A Statistical Tool for Quantitative Analysis of-Omics Data.”</span> <em>Bioinformatics</em> 24 (13): 1556–58.
</div>
<div id="ref-stacklies2007pcamethods" class="csl-entry">
Stacklies, Wolfram, Henning Redestig, Matthias Scholz, Dirk Walther, and Joachim Selbig. 2007. <span>“pcaMethods—a Bioconductor Package Providing PCA Methods for Incomplete Data.”</span> <em>Bioinformatics</em> 23 (9): 1164–67.
</div>
<div id="ref-webb2014bayesian" class="csl-entry">
Webb-Robertson, Bobbie-Jo M, Melissa M Matzke, Susmita Datta, Samuel H Payne, Jiyun Kang, Lisa M Bramer, Carrie D Nicora, et al. 2014. <span>“Bayesian Proteoform Modeling Improves Protein Quantification of Global Proteomic Measurements.”</span> <em>Molecular &amp; Cellular Proteomics</em> 13 (12): 3639–46.
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Lisa Bramer, Kelly Stratton.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>

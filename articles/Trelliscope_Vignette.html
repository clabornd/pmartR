<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Using Trelliscope Functions with pmartR • pmartR</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Using Trelliscope Functions with pmartR">
<meta property="og:description" content="pmartR">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">pmartR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.2.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Quality_Control_with_pmartR.html">Quality Control and Normalization of Peptide Data with the `pmartR` Package</a>
    </li>
    <li>
      <a href="../articles/Statistical_Analysis_with_pmartR.html">Statistical Analysis with the `pmartR` Package</a>
    </li>
    <li>
      <a href="../articles/Trelliscope_Vignette.html">Using Trelliscope Functions with pmartR</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/pmartR/pmartR/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="Trelliscope_Vignette_files/htmlwidgets-1.5.4/htmlwidgets.js"></script><script src="Trelliscope_Vignette_files/plotly-binding-4.10.0/plotly.js"></script><script src="Trelliscope_Vignette_files/typedarray-0.1/typedarray.min.js"></script><link href="Trelliscope_Vignette_files/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet">
<script src="Trelliscope_Vignette_files/crosstalk-1.2.0/js/crosstalk.min.js"></script><link href="Trelliscope_Vignette_files/plotly-htmlwidgets-css-2.5.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="Trelliscope_Vignette_files/plotly-main-2.5.1/plotly-latest.min.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Using Trelliscope Functions with pmartR</h1>
                        <h4 data-toc-skip class="author">David Degnan, Kelly Stratton, Lisa Bramer</h4>
            
            <h4 data-toc-skip class="date">2022-10-13</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/pmartR/pmartR/blob/HEAD/vignettes/Trelliscope_Vignette.Rmd" class="external-link"><code>vignettes/Trelliscope_Vignette.Rmd</code></a></small>
      <div class="hidden name"><code>Trelliscope_Vignette.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>A challenge of ’omics data is seeing trends on the biomolecule, sample, and biomolecule class (i.e. peptide fragments from a protein) level due to the large number of individual plots to visualize. Trelliscope is an HTML tool which allows users to search, sort, and filter plots based on <strong>cognostics</strong>, which include single data descriptors of the data like the mean, standard deviation, p-value, etc.</p>
<p>The general workflow for the trelliscope builder functions in pmartR are as follows:</p>
<ol style="list-style-type: decimal">
<li>build the trelliscope data object with an e_data file, omicsData object0, statRes object, or both an omicsData and statRes object. (<code>as.trelliData.edata</code> or <code>as.trelliData</code>)</li>
</ol>
<p>Note: The e_data file is an unprocessed expression matrix. The omicData object is a pepData, proData, lipidData, etc., object that has completed normalization if required. The statRes object contains the statistics results following an imd-ANOVA.</p>
<ol start="2" style="list-style-type: decimal">
<li><p>select the variable to panel the data by (<code>trelli_panel_by</code>)</p></li>
<li><p>and finally, pass to the corresponding trelliscope building functions</p></li>
</ol>
<p>Currently, abundance, missingness, and fold change plots are supported, and can be summarized as follows:</p>
<table class="table">
<colgroup>
<col width="10%">
<col width="8%">
<col width="10%">
<col width="12%">
<col width="11%">
<col width="31%">
<col width="15%">
</colgroup>
<thead><tr class="header">
<th align="left">Input.Data</th>
<th align="left">Plot.Type</th>
<th align="left">Uses.e_data</th>
<th align="left">Uses.omicsData</th>
<th align="left">Uses.statRes</th>
<th align="left">Requires.Biomolecule.Class..e_meta.</th>
<th align="left">Main.Effects.Used</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Abundance</td>
<td align="left">Boxplot</td>
<td align="left">X</td>
<td align="left">X</td>
<td align="left"></td>
<td align="left"></td>
<td align="left">X</td>
</tr>
<tr class="even">
<td align="left">Abundance</td>
<td align="left">Histogram</td>
<td align="left">X</td>
<td align="left">X</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">Abundance</td>
<td align="left">Heatmap</td>
<td align="left"></td>
<td align="left">X</td>
<td align="left"></td>
<td align="left">X</td>
<td align="left">X</td>
</tr>
<tr class="even">
<td align="left">Missingness</td>
<td align="left">Barplot</td>
<td align="left">X</td>
<td align="left">X</td>
<td align="left">X</td>
<td align="left"></td>
<td align="left">X</td>
</tr>
<tr class="odd">
<td align="left">Fold Change</td>
<td align="left">Barplot</td>
<td align="left"></td>
<td align="left"></td>
<td align="left">X</td>
<td align="left"></td>
<td align="left">X</td>
</tr>
<tr class="even">
<td align="left">Fold Change</td>
<td align="left">Boxplot</td>
<td align="left"></td>
<td align="left"></td>
<td align="left">X</td>
<td align="left">X</td>
<td align="left">X</td>
</tr>
<tr class="odd">
<td align="left">Fold Change</td>
<td align="left">Volcano</td>
<td align="left"></td>
<td align="left"></td>
<td align="left">X</td>
<td align="left">X</td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">Fold Change</td>
<td align="left">Heatmap</td>
<td align="left"></td>
<td align="left"></td>
<td align="left">X</td>
<td align="left">X</td>
<td align="left"></td>
</tr>
</tbody>
</table>
<p>where “Input Data” is the type of data that will be plotted and “Plot Type” describes what kind of plot would be generated in the trelliscope. “Uses e_data” describes plots that can be made with just an e_data object using the <code>as.trelliData.edata</code> function. Similarly, “Uses omicsData” describes plots that can be made with an omicsData object (pepData, proData, lipidData, nmrData, etc.) in the <code>as.trelliData</code> function. “Uses statRes” describes plots that can be built with a statRes object in <code>as.trelliData</code>; however, most of these plots “Require e_meta” from omicsData to determine trelliscope panels. The last column, “Main Effects used” describes any plot where the “main_effects” parameter in <code><a href="../reference/group_designation.html">pmartR::group_designation</a></code> plot was set.</p>
</div>
<div class="section level2">
<h2 id="plot-summary">Plot Summary<a class="anchor" aria-label="anchor" href="#plot-summary"></a>
</h2>
<p><img src="TrelliData_Plotting_Options.png"><!-- --></p>
</div>
<div class="section level2">
<h2 id="example-case-1-e_data-only">Example Case 1: e_data Only<a class="anchor" aria-label="anchor" href="#example-case-1-e_data-only"></a>
</h2>
<p>Let’s start with the simplest input data to run these trelliscope functions, e_data. For context, a typical e_data file looks like this:</p>
<table class="table">
<colgroup>
<col width="13%">
<col width="7%">
<col width="7%">
<col width="7%">
<col width="8%">
<col width="8%">
<col width="8%">
<col width="8%">
<col width="8%">
<col width="8%">
<col width="8%">
<col width="8%">
</colgroup>
<thead><tr class="header">
<th align="left">LipidCommonName</th>
<th align="right">Mock1</th>
<th align="right">Mock2</th>
<th align="right">Mock3</th>
<th align="right">Infection1</th>
<th align="right">Infection2</th>
<th align="right">Infection3</th>
<th align="right">Infection4</th>
<th align="right">Infection6</th>
<th align="right">Infection7</th>
<th align="right">Infection8</th>
<th align="right">Infection9</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Cer(d18:0/16:0)</td>
<td align="right">307384.88</td>
<td align="right">388635.22</td>
<td align="right">332032.95</td>
<td align="right">775978.9</td>
<td align="right">960886.0</td>
<td align="right">697505.46</td>
<td align="right">564257.8</td>
<td align="right">NA</td>
<td align="right">466349.01</td>
<td align="right">56384.40</td>
<td align="right">429000.30</td>
</tr>
<tr class="even">
<td align="left">Cer(d18:0/22:0)</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">293545.6</td>
<td align="right">75020.31</td>
<td align="right">156391.1</td>
<td align="right">85233.24</td>
<td align="right">44918.62</td>
<td align="right">NA</td>
<td align="right">66104.86</td>
</tr>
<tr class="odd">
<td align="left">Cer(d18:0/24:0)</td>
<td align="right">59442.36</td>
<td align="right">73989.48</td>
<td align="right">45173.44</td>
<td align="right">274673.0</td>
<td align="right">150737.3</td>
<td align="right">419250.96</td>
<td align="right">121000.2</td>
<td align="right">93570.35</td>
<td align="right">82387.91</td>
<td align="right">36936.53</td>
<td align="right">28011.50</td>
</tr>
<tr class="even">
<td align="left">Cer(d18:0/24:1)</td>
<td align="right">43464.48</td>
<td align="right">31148.65</td>
<td align="right">130995.66</td>
<td align="right">432901.0</td>
<td align="right">927511.4</td>
<td align="right">528311.11</td>
<td align="right">518819.3</td>
<td align="right">300644.47</td>
<td align="right">195772.16</td>
<td align="right">13031.36</td>
<td align="right">384786.88</td>
</tr>
<tr class="odd">
<td align="left">Cer(d18:1/24:1)</td>
<td align="right">30349.88</td>
<td align="right">33225.59</td>
<td align="right">61498.13</td>
<td align="right">270888.0</td>
<td align="right">448486.3</td>
<td align="right">NA</td>
<td align="right">319427.7</td>
<td align="right">131777.53</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">CerH2O(d18:1/16:0)</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">399576.3</td>
<td align="right">171359.5</td>
<td align="right">465004.79</td>
<td align="right">512264.4</td>
<td align="right">356657.96</td>
<td align="right">216712.81</td>
<td align="right">NA</td>
<td align="right">486943.97</td>
</tr>
</tbody>
</table>
<p>where each of the rows are biomolecules and each of the columns are samples. Within each e_data file, there must be one identifier column referred to as the “edata_cname.” The rest of the columns contain samples. With the exception of isobaric peptide data and nmr data, all data types must be log transformed and normalized. After setting the e_data and edata_cname parameters in the <code>as.trelliData.edata</code> function, the next step is to set the omics_type which are all currently supported pmartR omics types. Set a transformation by first reporting the original data scale in the data_scale_original and the desired scale in data_scale. “log2”, “log10”, “log”, and “abundance” (no transformation) are currently supported.</p>
<p>To understand the array of normalization functions and parameters, see <code><a href="../reference/normalize_global.html">?normalize_global</a></code>, <code><a href="../reference/normalize_loess.html">?normalize_loess</a></code> and <code><a href="../reference/normalize_quantile.html">?normalize_quantile</a></code>. Below, we have an example of valid log transformation and normalization parameters.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">trelliData1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/as.trelliData.edata.html">as.trelliData.edata</a></span><span class="op">(</span></span>
<span>  e_data <span class="op">=</span> <span class="fu">pmartRdata</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/pmartRdata/man/lipid_edata_pos.html" class="external-link">lipid_edata_pos</a></span>,</span>
<span>  edata_cname <span class="op">=</span> <span class="st">"LipidCommonName"</span>,</span>
<span>  omics_type <span class="op">=</span> <span class="st">"lipidData"</span>,</span>
<span>  data_scale_original <span class="op">=</span> <span class="st">"abundance"</span>,</span>
<span>  data_scale <span class="op">=</span> <span class="st">"log2"</span>,</span>
<span>  normalization_fun <span class="op">=</span> <span class="st">"global"</span>,</span>
<span>  normalization_params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>subset_fn <span class="op">=</span> <span class="st">"all"</span>, norm_fn <span class="op">=</span> <span class="st">"median"</span>, apply_norm <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    backtransform <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>After creating a trelliData object, the next step is to determine which variable to panel the data by. The <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">?summary</a></code> function provides a quick overview of potential plots that can be made.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">trelliData1</span><span class="op">)</span> </span></code></pre></div>
<pre><code><span><span class="co">##    Panel By Choice                Plot Number of Plots</span></span>
<span><span class="co">## 1: LipidCommonName   abundance boxplot             146</span></span>
<span><span class="co">## 2: LipidCommonName abundance histogram             146</span></span>
<span><span class="co">## 3: LipidCommonName     missingness bar             146</span></span>
<span><span class="co">## 4:          Sample   abundance boxplot              11</span></span>
<span><span class="co">## 5:          Sample     missingness bar              11</span></span></code></pre>
<p>With only an e_data file, there are only two potential options for panel by variables, which include the edata_cname (in this case, “LipidCommonName”), and a “Sample” category which is comprised of the name of every column besides edata_cname. The plot, which corresponds to the table in the introduction, can be further investigated with adding trelli and underscores to the name. For example, the “abundance boxplot” details be viewed with <code><a href="../reference/trelli_abundance_boxplot.html">?trelli_abundance_boxplot</a></code>. The last column tells you the number of plots that can be made with that trelliscope function. Note that trelliscopes of more than 1,000 plots can take several minutes to be made.</p>
<p>To set the panels for the trelliscope, use the <code><a href="../reference/trelli_panel_by.html">?trelli_panel_by</a></code> function. We only have two options in this case, so a summary for plots where each panel is the biomolecule (edata_cname = “Lipid”) looks like this:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">trelliData1</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="../reference/trelli_panel_by.html">trelli_panel_by</a></span><span class="op">(</span><span class="st">"LipidCommonName"</span><span class="op">)</span><span class="op">)</span> </span></code></pre></div>
<pre><code><span><span class="co">##    Panel By Choice                Plot Number of Plots</span></span>
<span><span class="co">## 1: LipidCommonName   abundance boxplot             146</span></span>
<span><span class="co">## 2: LipidCommonName abundance histogram             146</span></span>
<span><span class="co">## 3: LipidCommonName     missingness bar             146</span></span></code></pre>
<p>which is the above table subsetted down to the only options available to plot right now. The typical trelliscope parameters look like this:</p>
<table class="table">
<colgroup>
<col width="16%">
<col width="83%">
</colgroup>
<thead><tr class="header">
<th align="left">Parameter.Name</th>
<th align="left">Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">cognostics</td>
<td align="left">Set the specific cognostics of the trelliscope. Varies per plotting function.</td>
</tr>
<tr class="even">
<td align="left">ggplot_params</td>
<td align="left">Pass parameters to the ggplot functions as a list of strings</td>
</tr>
<tr class="odd">
<td align="left">interactive</td>
<td align="left">Indicate whether plots should be interactive or not</td>
</tr>
<tr class="even">
<td align="left">path</td>
<td align="left">The path where the trelliscope will be outputted to</td>
</tr>
<tr class="odd">
<td align="left">name</td>
<td align="left">Name of the trelliscope display</td>
</tr>
<tr class="even">
<td align="left">test_mode</td>
<td align="left">Indicate whether the trelliscope should be subsetted to a few panels or not</td>
</tr>
<tr class="odd">
<td align="left">test_example</td>
<td align="left">The panels to subset the trelliscope to if test_mode is true</td>
</tr>
<tr class="even">
<td align="left">single_plot</td>
<td align="left">Output a single plot instead of a trelliscope display</td>
</tr>
</tbody>
</table>
<p>See an example of how to use one of these functions below, with test_mode enabled.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/trelli_abundance_boxplot.html">trelli_abundance_boxplot</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="../reference/trelli_panel_by.html">trelli_panel_by</a></span><span class="op">(</span><span class="va">trelliData1</span>, <span class="st">"LipidCommonName"</span><span class="op">)</span>,</span>
<span>  cognostics <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"n"</span>, <span class="st">"mean"</span>, <span class="st">"median"</span>, <span class="st">"sd"</span><span class="op">)</span>,</span>
<span>  interactive <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  include_points <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  name <span class="op">=</span> <span class="st">"Trelliscope"</span>,</span>
<span>  test_mode <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  test_example <span class="op">=</span> <span class="fl">3</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Also, see “How Do I Change ggplot Parameters?” below to understand how to change axis and title labels, sizes, and angles, as well as change plot colors, etc. All plotting commands follow the ggplot2 library of functions. To see what each trelliscope looks like, start by investigating the default plot option with single_plot = TRUE and selecting a specific plot with test_example.</p>
<p><strong>Abundance Boxplot</strong></p>
<p>Let’s first create two panel_by trelliscope objects, one by “Lipid”, and the other by “Sample”. If we were to plot the first sample’s boxplot abundance with include_points = TRUE, we would get too many points to view. Thus, set include_points to FALSE. Since we’ve set “single_plot” to TRUE, we get an example of one of the many plots that will be made and passed to trelliscope. We can change which plot we’re looking at with “test_example”. On the left, we have a “LipidCommonName” example and on the right, a “Sample” example, with the color changed to avoid confusion.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Panel by Mass Tag ID  </span></span>
<span><span class="va">MassGroups</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/trelli_panel_by.html">trelli_panel_by</a></span><span class="op">(</span><span class="va">trelliData1</span>, <span class="st">"LipidCommonName"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Panel by Sample</span></span>
<span><span class="va">SampleGroups</span> <span class="op">&lt;-</span> <span class="va">trelliData1</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="../reference/trelli_panel_by.html">trelli_panel_by</a></span><span class="op">(</span><span class="st">"Sample"</span><span class="op">)</span> </span>
<span></span>
<span><span class="co"># Create an example boxplot </span></span>
<span><span class="va">Abun_Box_Edata</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/trelli_abundance_boxplot.html">trelli_abundance_boxplot</a></span><span class="op">(</span><span class="va">MassGroups</span>, single_plot <span class="op">=</span> <span class="cn">TRUE</span>, test_example <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Make an abundance boxplot without the points </span></span>
<span><span class="va">Abun_Box_Sample</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/trelli_abundance_boxplot.html">trelli_abundance_boxplot</a></span><span class="op">(</span><span class="va">SampleGroups</span>, include_points <span class="op">=</span> <span class="cn">F</span>, single_plot <span class="op">=</span> <span class="cn">T</span>,</span>
<span>                                            ggplot_params <span class="op">=</span> <span class="st">"scale_fill_manual(values = 'forestgreen')"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Use patchwork to put plots together</span></span>
<span><span class="va">Abun_Box_Edata</span> <span class="op">+</span> <span class="va">Abun_Box_Sample</span></span></code></pre></div>
<p><img src="Trelliscope_Vignette_files/figure-html/unnamed-chunk-9-1.png" width="700"></p>
<p><strong>Abundance Histogram</strong></p>
<p>The abundance histogram is only supported for data that has been paneled by edata_cname.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/trelli_abundance_histogram.html">trelli_abundance_histogram</a></span><span class="op">(</span><span class="va">MassGroups</span>, single_plot <span class="op">=</span> <span class="cn">TRUE</span>, test_example <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<p><img src="Trelliscope_Vignette_files/figure-html/unnamed-chunk-10-1.png" width="700"></p>
<p><strong>Missingness Barplot</strong></p>
<p>We can also build a missingness bar plots. In this data, there is no missingness, so we will use a different dataset to better demonstrate how these plots look. If we would rather see count information in the bar plot instead of proportions, we can easily set proportion to FALSE.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Pull from the smoking dataset</span></span>
<span><span class="va">smoke_trelliData</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/as.trelliData.edata.html">as.trelliData.edata</a></span><span class="op">(</span></span>
<span>  e_data <span class="op">=</span> <span class="fu">pmartRdata</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/pmartRdata/man/smoke_edata.html" class="external-link">smoke_edata</a></span>,</span>
<span>  edata_cname <span class="op">=</span> <span class="st">"Mass_Tag_ID"</span>,</span>
<span>  omics_type <span class="op">=</span> <span class="st">"pepData"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create an example bar plot </span></span>
<span><span class="va">Miss_Bar_Edata</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/trelli_missingness_bar.html">trelli_missingness_bar</a></span><span class="op">(</span><span class="fu"><a href="../reference/trelli_panel_by.html">trelli_panel_by</a></span><span class="op">(</span><span class="va">smoke_trelliData</span>, <span class="st">"Mass_Tag_ID"</span><span class="op">)</span>, </span>
<span>                                         single_plot <span class="op">=</span> <span class="cn">TRUE</span>, test_example <span class="op">=</span> <span class="fl">3</span>,</span>
<span>                                         ggplot_params <span class="op">=</span> <span class="st">"ggtitle('Biomolecule')"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Make a missingness barplot </span></span>
<span><span class="va">Miss_Bar_Sample</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/trelli_missingness_bar.html">trelli_missingness_bar</a></span><span class="op">(</span><span class="fu"><a href="../reference/trelli_panel_by.html">trelli_panel_by</a></span><span class="op">(</span><span class="va">smoke_trelliData</span>, <span class="st">"Sample"</span><span class="op">)</span>, </span>
<span>                                          include_points <span class="op">=</span> <span class="cn">F</span>, </span>
<span>                                          proportion <span class="op">=</span> <span class="cn">FALSE</span>, single_plot <span class="op">=</span> <span class="cn">T</span>,</span>
<span>                                          ggplot_params <span class="op">=</span> <span class="st">"ggtitle('Sample')"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Put plots together with patchwork</span></span>
<span><span class="va">Miss_Bar_Edata</span> <span class="op">+</span> <span class="va">Miss_Bar_Sample</span></span></code></pre></div>
<p><img src="Trelliscope_Vignette_files/figure-html/unnamed-chunk-11-1.png" width="700"></p>
<p>These are all the currently supported plots for only e_data files. There are more options for omicsData and statRes listed below.</p>
</div>
<div class="section level2">
<h2 id="example-case-2-omicsdata-only">Example Case 2: omicsData Only<a class="anchor" aria-label="anchor" href="#example-case-2-omicsdata-only"></a>
</h2>
<p>An omicsData object that is log transformed and normalized (with the exception of isobaric and nmr data) can be passed to the <code>as.trelliData</code> function which requires either an omicsData or statRes object.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Extract and add lipid family information</span></span>
<span><span class="va">lipid_emeta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="st">"LipidCommonName"</span> <span class="op">=</span> <span class="va">lipid_edata_pos</span><span class="op">$</span><span class="va">LipidCommonName</span>, </span>
<span>  <span class="st">"LipidFamily"</span> <span class="op">=</span> <span class="va">lipid_edata_pos</span><span class="op">$</span><span class="va">LipidCommonName</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/strsplit.html" class="external-link">strsplit</a></span><span class="op">(</span><span class="st">"("</span>, fixed <span class="op">=</span> <span class="cn">T</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="kw">function</span><span class="op">(</span><span class="va">el</span><span class="op">)</span> <span class="op">{</span><span class="va">el</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">}</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Extend fdata to have two infection groups </span></span>
<span><span class="va">lipid_fdata_pos2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="st">"Sample_Name"</span> <span class="op">=</span> <span class="va">lipid_fdata_pos</span><span class="op">$</span><span class="va">Sample_Name</span>, </span>
<span>  <span class="st">"Condition"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"Mock"</span>, <span class="fl">3</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"Infection_A"</span>, <span class="fl">4</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"Infection_B"</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="st">"Weight"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">11</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Build lipid data object</span></span>
<span><span class="va">lipids</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/as.lipidData.html">as.lipidData</a></span><span class="op">(</span>e_data <span class="op">=</span> <span class="va">lipid_edata_pos</span>, f_data <span class="op">=</span> <span class="va">lipid_fdata_pos2</span>, e_meta <span class="op">=</span> <span class="va">lipid_emeta</span>,</span>
<span>  edata_cname <span class="op">=</span> <span class="st">"LipidCommonName"</span>, fdata_cname <span class="op">=</span> <span class="st">"Sample_Name"</span>, </span>
<span>  emeta_cname <span class="op">=</span> <span class="st">"LipidCommonName"</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># Log transform the edata file </span></span>
<span><span class="va">lipids</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/edata_transform.html">edata_transform</a></span><span class="op">(</span>omicsData <span class="op">=</span> <span class="va">lipids</span>, data_scale <span class="op">=</span> <span class="st">"log2"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Set the group designation main effects </span></span>
<span><span class="va">lipids</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/group_designation.html">group_designation</a></span><span class="op">(</span>omicsData <span class="op">=</span> <span class="va">lipids</span>, main_effects <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Condition"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Filter the data to run the imd_anova</span></span>
<span><span class="va">imdanova_Filt</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/imdanova_filter.html">imdanova_filter</a></span><span class="op">(</span>omicsData <span class="op">=</span> <span class="va">lipids</span><span class="op">)</span></span>
<span><span class="va">lipids</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/applyFilt.html">applyFilt</a></span><span class="op">(</span>filter_object <span class="op">=</span> <span class="va">imdanova_Filt</span>, omicsData <span class="op">=</span> <span class="va">lipids</span>, min_nonmiss_anova<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Normalize the data. You may use the Kruskal-Wallis test from normRes_tests to </span></span>
<span><span class="co"># confirm that your normalization choice does not induce nor remove significance. </span></span>
<span><span class="va">lipids</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/normalize_global.html">normalize_global</a></span><span class="op">(</span><span class="va">lipids</span>, subset_fn <span class="op">=</span> <span class="st">"rip"</span>, norm_fn <span class="op">=</span> <span class="st">"median"</span>, </span>
<span>                             apply_norm <span class="op">=</span> <span class="cn">TRUE</span>, backtransform <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create trelliData object</span></span>
<span><span class="va">trelliData2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/as.trelliData.html">as.trelliData</a></span><span class="op">(</span>omicsData <span class="op">=</span> <span class="va">lipids</span><span class="op">)</span></span></code></pre></div>
<p>If we summarize the plot options with <code>summary</code>, we get:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">trelliData2</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##    Panel By Choice                Plot Number of Plots</span></span>
<span><span class="co">## 1: LipidCommonName   abundance boxplot              66</span></span>
<span><span class="co">## 2: LipidCommonName abundance histogram              66</span></span>
<span><span class="co">## 3: LipidCommonName     missingness bar              66</span></span>
<span><span class="co">## 4:     Sample_Name   abundance boxplot              11</span></span>
<span><span class="co">## 5:     Sample_Name     missingness bar              11</span></span>
<span><span class="co">## 6:     LipidFamily   abundance boxplot               9</span></span>
<span><span class="co">## 7:     LipidFamily   abundance heatmap               9</span></span>
<span><span class="co">## 8:     LipidFamily     missingness bar               9</span></span></code></pre>
<p>Since we included an e_meta object that has categorical data for e_data, there are a lot more plotting options available then what was provided for the e_data file. Additionally, we have provided grouping information with the “group_designation” function which will be incorporated into some of the plotting functions. Since we’ve already covered the trelliscope building functions, we will focus these next few sections on how each e_meta and group_designation affect each plot.</p>
<p><strong>Abundance Boxplot</strong></p>
<p>The group_designation variables are utilized in the abundance boxplot when paneling by edata_cname (“LipidCommonName”)…</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">trelliData2</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/trelli_panel_by.html">trelli_panel_by</a></span><span class="op">(</span><span class="st">"LipidCommonName"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/trelli_abundance_boxplot.html">trelli_abundance_boxplot</a></span><span class="op">(</span>test_example <span class="op">=</span> <span class="fl">3</span>, single_plot <span class="op">=</span> <span class="cn">T</span>, ggplot_params <span class="op">=</span> <span class="st">"xlab('Viral Strain')"</span><span class="op">)</span></span></code></pre></div>
<p><img src="Trelliscope_Vignette_files/figure-html/unnamed-chunk-14-1.png" width="700"></p>
<p>…or e_meta variable. In this case, our options include LipidFamily. Note that group_designation is used if included:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">trelliData2</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/trelli_panel_by.html">trelli_panel_by</a></span><span class="op">(</span><span class="st">"LipidFamily"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/trelli_abundance_boxplot.html">trelli_abundance_boxplot</a></span><span class="op">(</span>test_example <span class="op">=</span> <span class="fl">6</span>, single_plot <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span></code></pre></div>
<p><img src="Trelliscope_Vignette_files/figure-html/unnamed-chunk-15-1.png" width="700"></p>
<p>If we panel by the sample, the plot remains the same as in example case 1.</p>
<p><strong>Abundance Histogram</strong></p>
<p>Since group_designation is not used in the histogram trelliscope plotting function, it remains the same as in Example Case 1.</p>
<p><strong>Missingness Bar</strong></p>
<p>Once again, group_designation data is used if included, even if the panel_by variable is an e_meta variable.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">trelliData2</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/trelli_panel_by.html">trelli_panel_by</a></span><span class="op">(</span><span class="st">"LipidFamily"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/trelli_missingness_bar.html">trelli_missingness_bar</a></span><span class="op">(</span>test_example <span class="op">=</span> <span class="fl">3</span>, single_plot <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span></code></pre></div>
<p><img src="Trelliscope_Vignette_files/figure-html/unnamed-chunk-16-1.png" width="700"></p>
<p><strong>Abundance Heatmap</strong></p>
<p>An advantage to including e_meta variables is the ability to use heatmaps, where each panel is an “e_meta” variable, one axis is the biomolecules within that biomolecule class, and the other axis is the samples in order by the “group_by” designation.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">trelliData2</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/trelli_panel_by.html">trelli_panel_by</a></span><span class="op">(</span><span class="st">"LipidFamily"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/trelli_abundance_heatmap.html">trelli_abundance_heatmap</a></span><span class="op">(</span>test_example <span class="op">=</span> <span class="fl">2</span>, single_plot <span class="op">=</span> <span class="cn">T</span>, ggplot_params <span class="op">=</span> <span class="st">"coord_flip()"</span><span class="op">)</span></span></code></pre></div>
<p><img src="Trelliscope_Vignette_files/figure-html/unnamed-chunk-17-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="example-case-3-statres-only">Example Case 3: statRes Only<a class="anchor" aria-label="anchor" href="#example-case-3-statres-only"></a>
</h2>
<p>Including statRes data allows for trelliscope plots that accept fold_change values. To get a statRes object, pass your transformed, filtered, and normalized data to the <code><a href="../reference/imd_anova.html">?imd_anova</a></code> function.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Since nothing is missing from this dataset, there is no need to run the G-test. </span></span>
<span><span class="va">lipidStats</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/imd_anova.html">imd_anova</a></span><span class="op">(</span><span class="va">lipids</span>, test_method <span class="op">=</span> <span class="st">"anova"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Pass that dataframe to the trelliData object builder</span></span>
<span><span class="va">trelliData3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/as.trelliData.html">as.trelliData</a></span><span class="op">(</span>statRes <span class="op">=</span> <span class="va">lipidStats</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Run the summary function</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">trelliData3</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##    Panel By Choice            Plot Number of Plots</span></span>
<span><span class="co">## 1: LipidCommonName missingness bar              66</span></span>
<span><span class="co">## 2: LipidCommonName fold change bar              66</span></span></code></pre>
<p>There are only two trelliscope plotting options for statRes objects by themselves. The missingness plot, which we have seen above, and a fold change bar plot. Fold change plots have two additional parameters: p_value_test, which allows users to choose TRUE/FALSE for determining which significance tests should be highlighted at a specific p value threshold (p_value_thresh).</p>
<p><strong>Foldchange Bar</strong></p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">trelliData3</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/trelli_panel_by.html">trelli_panel_by</a></span><span class="op">(</span><span class="st">"LipidCommonName"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/trelli_foldchange_bar.html">trelli_foldchange_bar</a></span><span class="op">(</span>p_value_thresh <span class="op">=</span> <span class="fl">0.05</span>, p_value_test <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>                        test_example <span class="op">=</span> <span class="fl">3</span>, single_plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="Trelliscope_Vignette_files/figure-html/unnamed-chunk-19-1.png" width="700"></p>
<p>To see more fold change plot options, include an e_meta dataframe in the trelliData object.</p>
</div>
<div class="section level2">
<h2 id="example-case-4-omicsdata-and-statres">Example Case 4: omicsData and statRes<a class="anchor" aria-label="anchor" href="#example-case-4-omicsdata-and-statres"></a>
</h2>
<p>Including both omicsData and statRes objects allows users the ability to run all available plotting functions. Below, we will focus on the last fold change plots that we have yet to see.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Build a trelliData object with both omicsData and statRes</span></span>
<span><span class="va">trelliData4</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/as.trelliData.html">as.trelliData</a></span><span class="op">(</span>omicsData <span class="op">=</span> <span class="va">lipids</span>, statRes <span class="op">=</span> <span class="va">lipidStats</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">trelliData4</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##     Panel By Choice                Plot Number of Plots</span></span>
<span><span class="co">##  1: LipidCommonName   abundance boxplot              66</span></span>
<span><span class="co">##  2: LipidCommonName abundance histogram              66</span></span>
<span><span class="co">##  3: LipidCommonName     missingness bar              66</span></span>
<span><span class="co">##  4: LipidCommonName     fold change bar              66</span></span>
<span><span class="co">##  5:     Sample_Name   abundance boxplot              11</span></span>
<span><span class="co">##  6:     Sample_Name     missingness bar              11</span></span>
<span><span class="co">##  7:     LipidFamily   abundance boxplot               9</span></span>
<span><span class="co">##  8:     LipidFamily   abundance heatmap               9</span></span>
<span><span class="co">##  9:     LipidFamily     missingness bar               9</span></span>
<span><span class="co">## 10:     LipidFamily fold change boxplot               9</span></span>
<span><span class="co">## 11:     LipidFamily fold change heatmap               9</span></span>
<span><span class="co">## 12:     LipidFamily fold change volcano               9</span></span></code></pre>
<p><strong>Fold Change Boxplot</strong></p>
<p>To create a fold change boxplot, the input data must be paneled by an e_meta variable. If p_value_test is enabled, any points with a significant value are shaped as squares.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">trelliData4</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/trelli_panel_by.html">trelli_panel_by</a></span><span class="op">(</span><span class="st">"LipidFamily"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/trelli_foldchange_boxplot.html">trelli_foldchange_boxplot</a></span><span class="op">(</span></span>
<span>    single_plot <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    p_value_test <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    test_example <span class="op">=</span> <span class="fl">5</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="Trelliscope_Vignette_files/figure-html/unnamed-chunk-21-1.png" width="700"></p>
<p><strong>Fold Change Heatmap</strong></p>
<p>These heatmaps shows fold change values per biomolecule (y-axis) and statistical comparison (x-axis).</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">trelliData4</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/trelli_panel_by.html">trelli_panel_by</a></span><span class="op">(</span><span class="st">"LipidFamily"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/trelli_foldchange_heatmap.html">trelli_foldchange_heatmap</a></span><span class="op">(</span></span>
<span>    single_plot <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="Trelliscope_Vignette_files/figure-html/unnamed-chunk-22-1.png" width="700"></p>
<p><strong>Fold Change Volcano</strong></p>
<p>Volcano plots display the -log10 p-value versus the fold change values. Significant values with a low fold change are colored blue, and high ones are colored red. These plots require that a specific comparison is selected.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">trelliData4</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/trelli_panel_by.html">trelli_panel_by</a></span><span class="op">(</span><span class="st">"LipidFamily"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/trelli_foldchange_volcano.html">trelli_foldchange_volcano</a></span><span class="op">(</span></span>
<span>    comparison <span class="op">=</span> <span class="st">"Infection_A_vs_Infection_B"</span>,</span>
<span>    test_example <span class="op">=</span> <span class="fl">5</span>,</span>
<span>    single_plot <span class="op">=</span> <span class="cn">T</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="Trelliscope_Vignette_files/figure-html/unnamed-chunk-23-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="how-do-i">How Do I…<a class="anchor" aria-label="anchor" href="#how-do-i"></a>
</h2>
<div class="section level4">
<h4 id="change-ggplot-parameters">Change ggplot parameters<a class="anchor" aria-label="anchor" href="#change-ggplot-parameters"></a>
</h4>
<p>To make tweaks to the ggplot objects, pass the commands as strings in a list. For example:</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">trelliData2</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/trelli_panel_by.html">trelli_panel_by</a></span><span class="op">(</span><span class="st">"LipidCommonName"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/trelli_abundance_boxplot.html">trelli_abundance_boxplot</a></span><span class="op">(</span>test_example <span class="op">=</span> <span class="fl">3</span>, single_plot <span class="op">=</span> <span class="cn">T</span>,</span>
<span>    ggplot_params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ggtitle('CYC Human')"</span>, </span>
<span>                      <span class="st">"ylab('Log Adjusted Abundance')"</span>,</span>
<span>                      <span class="st">"xlab('')"</span>, <span class="st">"theme_classic()"</span>, </span>
<span>                      <span class="st">"theme(plot.title = ggplot2::element_text(hjust = 0.5))"</span>,</span>
<span>                      <span class="st">"theme(legend.position = 'none')"</span><span class="op">)</span>                       </span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="Trelliscope_Vignette_files/figure-html/unnamed-chunk-24-1.png" width="700"></p>
<p>Below is the a list of common functions and what they do.</p>
<table class="table">
<thead><tr class="header">
<th align="left">Function</th>
<th align="left">Purpose</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">xlab(‘Name’)</td>
<td align="left">Rename x-axis label</td>
</tr>
<tr class="even">
<td align="left">ylab(‘Name’)</td>
<td align="left">Rename y-axis label</td>
</tr>
<tr class="odd">
<td align="left">ggtitle(‘Name’)</td>
<td align="left">Rename plot</td>
</tr>
<tr class="even">
<td align="left">xlim(c(0,1))</td>
<td align="left">Set the x-axis limits</td>
</tr>
<tr class="odd">
<td align="left">ylim(c(0,1))</td>
<td align="left">Set the y-axis limits</td>
</tr>
<tr class="even">
<td align="left">coord_flip()</td>
<td align="left">Flip x- and y-axis</td>
</tr>
<tr class="odd">
<td align="left">theme(axis.title.x = ggplot2::element_text(size=16))</td>
<td align="left">Resize x-axis title</td>
</tr>
<tr class="even">
<td align="left">theme(axis.title.y = ggplot2::element_text(size=16))</td>
<td align="left">Resize y-axis title</td>
</tr>
<tr class="odd">
<td align="left">theme(axis.text.x = element_text(size=12))</td>
<td align="left">Resize x-axis ticks</td>
</tr>
<tr class="even">
<td align="left">theme(axis.text.y = element_text(size=12))</td>
<td align="left">Resize y-axis ticks</td>
</tr>
<tr class="odd">
<td align="left">theme(axis.text.x = element_text(angle=90))</td>
<td align="left">Rotate x-axis ticks</td>
</tr>
<tr class="even">
<td align="left">theme(axis.text.y = element_text(angle=90))</td>
<td align="left">Rotate y-axis ticks</td>
</tr>
<tr class="odd">
<td align="left">theme(plot.title = element_text(size=30))</td>
<td align="left">Change plot title size</td>
</tr>
</tbody>
</table>
<p>For a list of other ggplot functions, <a href="https://ggplot2.tidyverse.org/reference/" class="external-link">click here</a></p>
</div>
<div class="section level4">
<h4 id="make-the-plot-interactive">Make the plot interactive<a class="anchor" aria-label="anchor" href="#make-the-plot-interactive"></a>
</h4>
<p>Every plot has an interactive option by making interactive=TRUE.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">trelliData2</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/trelli_panel_by.html">trelli_panel_by</a></span><span class="op">(</span><span class="st">"LipidCommonName"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/trelli_abundance_boxplot.html">trelli_abundance_boxplot</a></span><span class="op">(</span>test_example <span class="op">=</span> <span class="fl">3</span>, single_plot <span class="op">=</span> <span class="cn">T</span>, interactive <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span></code></pre></div>
<div id="htmlwidget-41f95225b97823ff06c7" style="width:700px;height:432.632880098888px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-41f95225b97823ff06c7">{"x":{"data":[{"x":[1,1,1,1],"y":[17.8712227002445,17.4822769048688,18.1559653754569,16.486657467437],"hoverinfo":"y","type":"box","fillcolor":"rgba(248,118,109,1)","marker":{"opacity":null,"outliercolor":"rgba(0,0,0,1)","line":{"width":1.88976377952756,"color":"rgba(0,0,0,1)"},"size":5.66929133858268},"line":{"color":"rgba(51,51,51,1)","width":1.88976377952756},"name":"Infection_A","legendgroup":"Infection_A","showlegend":true,"xaxis":"x","yaxis":"y","frame":null},{"x":[2,2,2,2],"y":[16.1059069853065,16.7981157128413,16.0964111452903,15.2832814541785],"hoverinfo":"y","type":"box","fillcolor":"rgba(0,186,56,1)","marker":{"opacity":null,"outliercolor":"rgba(0,0,0,1)","line":{"width":1.88976377952756,"color":"rgba(0,0,0,1)"},"size":5.66929133858268},"line":{"color":"rgba(51,51,51,1)","width":1.88976377952756},"name":"Infection_B","legendgroup":"Infection_B","showlegend":true,"xaxis":"x","yaxis":"y","frame":null},{"x":[3,3,3],"y":[16.5678925889836,16.019841381034,14.1062770178925],"hoverinfo":"y","type":"box","fillcolor":"rgba(97,156,255,1)","marker":{"opacity":null,"outliercolor":"rgba(0,0,0,1)","line":{"width":1.88976377952756,"color":"rgba(0,0,0,1)"},"size":5.66929133858268},"line":{"color":"rgba(51,51,51,1)","width":1.88976377952756},"name":"Mock","legendgroup":"Mock","showlegend":true,"xaxis":"x","yaxis":"y","frame":null},{"x":[0.926212040241808,0.754180244519375,1.11914201197214,1.23971163516399],"y":[17.8712227002445,17.4822769048688,18.1559653754569,16.486657467437],"text":["Group: Infection_A<br />Abundance: 17.87122<br />Group: Infection_A","Group: Infection_A<br />Abundance: 17.48228<br />Group: Infection_A","Group: Infection_A<br />Abundance: 18.15597<br />Group: Infection_A","Group: Infection_A<br />Abundance: 16.48666<br />Group: Infection_A"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(248,118,109,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(0,0,0,1)"}},"hoveron":"points","name":"Infection_A","legendgroup":"Infection_A","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1.97022506734356,2.00303002563305,1.80472955177538,1.91284835117403],"y":[16.1059069853065,16.7981157128413,16.0964111452903,15.2832814541785],"text":["Group: Infection_B<br />Abundance: 16.10591<br />Group: Infection_B","Group: Infection_B<br />Abundance: 16.79812<br />Group: Infection_B","Group: Infection_B<br />Abundance: 16.09641<br />Group: Infection_B","Group: Infection_B<br />Abundance: 15.28328<br />Group: Infection_B"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(0,186,56,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(0,0,0,1)"}},"hoveron":"points","name":"Infection_B","legendgroup":"Infection_B","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[3.10528028919362,3.17127680697013,2.77418751001824],"y":[16.5678925889836,16.019841381034,14.1062770178925],"text":["Group: Mock<br />Abundance: 16.56789<br />Group: Mock","Group: Mock<br />Abundance: 16.01984<br />Group: Mock","Group: Mock<br />Abundance: 14.10628<br />Group: Mock"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(97,156,255,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(0,0,0,1)"}},"hoveron":"points","name":"Mock","legendgroup":"Mock","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":45.3588829941669,"r":7.30593607305936,"b":41.7789743183678,"l":37.2602739726027},"plot_bgcolor":"rgba(255,255,255,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"title":{"text":"Cer(d18:0/24:0)","font":{"color":"rgba(0,0,0,1)","family":"","size":17.5342465753425},"x":0.5,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0.4,3.6],"tickmode":"array","ticktext":["Infection_A","Infection_B","Mock"],"tickvals":[1,2,3],"categoryorder":"array","categoryarray":["Infection_A","Infection_B","Mock"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"y","title":{"text":"Group","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[13.9037926000143,18.3584497933351],"tickmode":"array","ticktext":["14","15","16","17","18"],"tickvals":[14,15,16,17,18],"categoryorder":"array","categoryarray":["14","15","16","17","18"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"x","title":{"text":"log2 Abundance","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":"transparent","line":{"color":"rgba(51,51,51,1)","width":0.66417600664176,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"3da725aedf39":{"x":{},"y":{},"fill":{},"type":"box"},"3da71cc99c3e":{"x":{},"y":{},"fill":{}}},"cur_data":"3da725aedf39","visdat":{"3da725aedf39":["function (y) ","x"],"3da71cc99c3e":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
<div class="section level4">
<h4 id="change-cognostics">Change cognostics<a class="anchor" aria-label="anchor" href="#change-cognostics"></a>
</h4>
<p>Every trelliscope plotting function has default diagnostics that can be changed or removed completely by setting cognostics to “NULL”. For example, if you were using the “trelli_abundance_boxplot” and only wanted a mean and median cognostic, you could set cognostics to c(“mean”, “median”).</p>
<table class="table">
<colgroup>
<col width="36%">
<col width="64%">
</colgroup>
<thead><tr class="header">
<th align="left">Functions</th>
<th align="left">Cognostics</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">trelli_abundance_boxplot</td>
<td align="left">n, mean, median, sd, skew, p_value, fold_change</td>
</tr>
<tr class="even">
<td align="left">trelli_abundance_histogram</td>
<td align="left">n, mean, median, sd, skew, p_value, fold_change</td>
</tr>
<tr class="odd">
<td align="left">trelli_abundance_heatmap</td>
<td align="left">n, mean, median, sd, skew</td>
</tr>
<tr class="even">
<td align="left">trelli_missingness_bar</td>
<td align="left">n, proportion</td>
</tr>
<tr class="odd">
<td align="left">trelli_foldchange_bar</td>
<td align="left">fold_change, p_value</td>
</tr>
<tr class="even">
<td align="left">trelli_foldchange_boxplot</td>
<td align="left">n, median, mean, sd</td>
</tr>
<tr class="odd">
<td align="left">trelli_foldchange_heatmap</td>
<td align="left">n, median, mean, sd</td>
</tr>
<tr class="even">
<td align="left">trelli_foldchange_volcano</td>
<td align="left">n</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section level2">
<h2 id="other-faqs">Other FAQs<a class="anchor" aria-label="anchor" href="#other-faqs"></a>
</h2>
<div class="section level4">
<h4 id="when-is-log-transformation-and-normalization-required">When is log transformation and normalization required?<a class="anchor" aria-label="anchor" href="#when-is-log-transformation-and-normalization-required"></a>
</h4>
<p>For every e_data and omicsData object that is not isobaric proteomics or NMR data, log transformation and normalization is required.</p>
</div>
<div class="section level4">
<h4 id="how-can-i-see-my-panel_by-options">How can I see my “panel_by” options?<a class="anchor" aria-label="anchor" href="#how-can-i-see-my-panel_by-options"></a>
</h4>
<p>“panel_by_options” are stored attributes in all trelliData objects.</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">trelliData4</span>, <span class="st">"panel_by_options"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "LipidCommonName" "Sample_Name"     "LipidFamily"</span></span></code></pre>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Lisa Bramer, Kelly Stratton.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
